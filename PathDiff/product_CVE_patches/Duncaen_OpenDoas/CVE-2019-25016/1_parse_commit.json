{
    "current_hash": "d5acd52e2a15c36a8e06f9103d35622933aa422d",
    "parent_hash": "01ac84109c99e94bf61c0a4039c76b8af289c499",
    "modified_file_0": {
        "mod_filename": "doas.c",
        "status": "modified",
        "add_lines": 3,
        "dele_lines": 0,
        "patch": "@@ -386,6 +386,7 @@ main(int argc, char **argv)\n \n #ifdef HAVE_LOGIN_CAP_H\n \tif (setusercontext(NULL, targpw, target, LOGIN_SETGROUP |\n+\t    LOGIN_SETPATH |\n \t    LOGIN_SETPRIORITY | LOGIN_SETRESOURCES | LOGIN_SETUMASK |\n \t    LOGIN_SETUSER) != 0)\n \t\terrx(1, \"failed to set user context for target\");\n@@ -396,6 +397,8 @@ main(int argc, char **argv)\n \t\terr(1, \"initgroups\");\n \tif (setresuid(target, target, target) != 0)\n \t\terr(1, \"setresuid\");\n+\tif (setenv(\"PATH\", safepath, 1) == -1)\n+\t\terr(1, \"failed to set PATH '%s'\", safepath);\n #endif\n \n \tif (getcwd(cwdpath, sizeof(cwdpath)) == NULL)"
    }
}