{
    "current_hash": "9a271a9368eaabf99e6c2046103acb33957e63b7",
    "parent_hash": "b8ff4f5ea3d321b7922e6862aab521ec18830d88",
    "modified_file_0": {
        "mod_filename": "libavcodec/jpeg2000dec.c",
        "status": "modified",
        "add_lines": 8,
        "dele_lines": 0,
        "patch": "@@ -384,6 +384,11 @@ static int get_cox(Jpeg2000DecoderContext *s, Jpeg2000CodingStyle *c)\n         return AVERROR_INVALIDDATA;\n     }\n \n+    if (c->log2_cblk_width > 6 || c->log2_cblk_height > 6) {\n+        avpriv_request_sample(s->avctx, \"cblk size > 64\");\n+        return AVERROR_PATCHWELCOME;\n+    }\n+\n     c->cblk_style = bytestream2_get_byteu(&s->g);\n     if (c->cblk_style != 0) { // cblk style\n         av_log(s->avctx, AV_LOG_WARNING, \"extra cblk styles %X\\n\", c->cblk_style);\n@@ -1025,6 +1030,9 @@ static int decode_cblk(Jpeg2000DecoderContext *s, Jpeg2000CodingStyle *codsty,\n     int bpass_csty_symbol           = codsty->cblk_style & JPEG2000_CBLK_BYPASS;\n     int vert_causal_ctx_csty_symbol = codsty->cblk_style & JPEG2000_CBLK_VSC;\n \n+    av_assert0(width  <= JPEG2000_MAX_CBLKW);\n+    av_assert0(height <= JPEG2000_MAX_CBLKH);\n+\n     for (y = 0; y < height; y++)\n         memset(t1->data[y], 0, width * sizeof(**t1->data));\n "
    }
}