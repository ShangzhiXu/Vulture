{
    "current_hash": "f31011e9abfb2ae75bb32bc44e2c34194c8dc40a",
    "parent_hash": "5dc6c0ea9ee7836df039c71259c7e538d7058243",
    "modified_file_0": {
        "mod_filename": "libavcodec/parser.c",
        "status": "modified",
        "add_lines": 7,
        "dele_lines": 3,
        "patch": "@@ -237,8 +237,10 @@ int ff_combine_frame(ParseContext *pc, int next, const uint8_t **buf, int *buf_s\n     if(next == END_NOT_FOUND){\n         void* new_buffer = av_fast_realloc(pc->buffer, &pc->buffer_size, (*buf_size) + pc->index + FF_INPUT_BUFFER_PADDING_SIZE);\n \n-        if(!new_buffer)\n+        if(!new_buffer) {\n+            pc->index = 0;\n             return AVERROR(ENOMEM);\n+        }\n         pc->buffer = new_buffer;\n         memcpy(&pc->buffer[pc->index], *buf, *buf_size);\n         pc->index += *buf_size;\n@@ -251,9 +253,11 @@ int ff_combine_frame(ParseContext *pc, int next, const uint8_t **buf, int *buf_s\n     /* append to buffer */\n     if(pc->index){\n         void* new_buffer = av_fast_realloc(pc->buffer, &pc->buffer_size, next + pc->index + FF_INPUT_BUFFER_PADDING_SIZE);\n-\n-        if(!new_buffer)\n+        if(!new_buffer) {\n+            pc->overread_index =\n+            pc->index = 0;\n             return AVERROR(ENOMEM);\n+        }\n         pc->buffer = new_buffer;\n         if (next > -FF_INPUT_BUFFER_PADDING_SIZE)\n             memcpy(&pc->buffer[pc->index], *buf,"
    }
}