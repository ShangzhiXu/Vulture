{
    "current_hash": "a5d25faa3f4b18dac737fdb35d0dd68eb0dc2156",
    "parent_hash": "a5f27a9c3aa973c543bd8bbf2a78363700bbc03e",
    "modified_file_0": {
        "mod_filename": "ffserver.c",
        "status": "modified",
        "add_lines": 4,
        "dele_lines": 1,
        "patch": "@@ -2738,8 +2738,10 @@ static int http_receive_data(HTTPContext *c)\n         } else if (c->buffer_ptr - c->buffer >= 2 &&\n                    !memcmp(c->buffer_ptr - 1, \"\\r\\n\", 2)) {\n             c->chunk_size = strtol(c->buffer, 0, 16);\n-            if (c->chunk_size == 0) // end of stream\n+            if (c->chunk_size <= 0) { // end of stream or invalid chunk size\n+                c->chunk_size = 0;\n                 goto fail;\n+            }\n             c->buffer_ptr = c->buffer;\n             break;\n         } else if (++loop_run > 10)\n@@ -2761,6 +2763,7 @@ static int http_receive_data(HTTPContext *c)\n             /* end of connection : close it */\n             goto fail;\n         else {\n+            av_assert0(len <= c->chunk_size);\n             c->chunk_size -= len;\n             c->buffer_ptr += len;\n             c->data_count += len;"
    }
}