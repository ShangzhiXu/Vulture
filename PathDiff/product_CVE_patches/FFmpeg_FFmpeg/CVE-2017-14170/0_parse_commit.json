{
    "current_hash": "900f39692ca0337a98a7cf047e4e2611071810c2",
    "parent_hash": "c24bcb553650b91e9eff15ef6e54ca73de2453b7",
    "modified_file_0": {
        "mod_filename": "libavformat/mxfdec.c",
        "status": "modified",
        "add_lines": 4,
        "dele_lines": 0,
        "patch": "@@ -899,6 +899,8 @@ static int mxf_read_index_entry_array(AVIOContext *pb, MXFIndexTableSegment *seg\n     segment->nb_index_entries = avio_rb32(pb);\n \n     length = avio_rb32(pb);\n+    if(segment->nb_index_entries && length < 11)\n+        return AVERROR_INVALIDDATA;\n \n     if (!(segment->temporal_offset_entries=av_calloc(segment->nb_index_entries, sizeof(*segment->temporal_offset_entries))) ||\n         !(segment->flag_entries          = av_calloc(segment->nb_index_entries, sizeof(*segment->flag_entries))) ||\n@@ -909,6 +911,8 @@ static int mxf_read_index_entry_array(AVIOContext *pb, MXFIndexTableSegment *seg\n     }\n \n     for (i = 0; i < segment->nb_index_entries; i++) {\n+        if(avio_feof(pb))\n+            return AVERROR_INVALIDDATA;\n         segment->temporal_offset_entries[i] = avio_r8(pb);\n         avio_r8(pb);                                        /* KeyFrameOffset */\n         segment->flag_entries[i] = avio_r8(pb);"
    }
}