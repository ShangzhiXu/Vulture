{
    "current_hash": "afc9c683ed9db01edb357bc8c19edad4282b3a97",
    "parent_hash": "9cb4eb772839c5e1de2855d126bf74ff16d13382",
    "modified_file_0": {
        "mod_filename": "libavformat/asfdec_f.c",
        "status": "modified",
        "add_lines": 5,
        "dele_lines": 0,
        "patch": "@@ -1610,6 +1610,11 @@ static int asf_build_simple_index(AVFormatContext *s, int stream_index)\n             int64_t pos       = s->internal->data_offset + s->packet_size * (int64_t)pktnum;\n             int64_t index_pts = FFMAX(av_rescale(itime, i, 10000) - asf->hdr.preroll, 0);\n \n+            if (avio_feof(s->pb)) {\n+                ret = AVERROR_INVALIDDATA;\n+                goto end;\n+            }\n+\n             if (pos != last_pos) {\n                 av_log(s, AV_LOG_DEBUG, \"pktnum:%d, pktct:%d  pts: %\"PRId64\"\\n\",\n                        pktnum, pktct, index_pts);"
    }
}