{
    "current_hash": "e371f031b942d73e02c090170975561fabd5c264",
    "parent_hash": "a0341b4d74f4db289e15dac0d2988eaa2d18a1bb",
    "modified_file_0": {
        "mod_filename": "libavcodec/pngdec.c",
        "status": "modified",
        "add_lines": 3,
        "dele_lines": 3,
        "patch": "@@ -437,13 +437,13 @@ static int decode_zbuf(AVBPrint *bp, const uint8_t *data,\n     av_bprint_init(bp, 0, -1);\n \n     while (zstream.avail_in > 0) {\n-        av_bprint_get_buffer(bp, 1, &buf, &buf_size);\n-        if (!buf_size) {\n+        av_bprint_get_buffer(bp, 2, &buf, &buf_size);\n+        if (buf_size < 2) {\n             ret = AVERROR(ENOMEM);\n             goto fail;\n         }\n         zstream.next_out  = buf;\n-        zstream.avail_out = buf_size;\n+        zstream.avail_out = buf_size - 1;\n         ret = inflate(&zstream, Z_PARTIAL_FLUSH);\n         if (ret != Z_OK && ret != Z_STREAM_END) {\n             ret = AVERROR_EXTERNAL;"
    }
}