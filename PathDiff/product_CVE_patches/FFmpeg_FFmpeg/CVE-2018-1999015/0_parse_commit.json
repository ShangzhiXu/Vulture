{
    "current_hash": "5aba5b89d0b1d73164d3b81764828bb8b20ff32a",
    "parent_hash": "e37741d26a1ef2d07e2ccf4e1bc9699a12576111",
    "modified_file_0": {
        "mod_filename": "libavcodec/mpeg4videodec.c",
        "status": "modified",
        "add_lines": 10,
        "dele_lines": 1,
        "patch": "@@ -2867,11 +2867,13 @@ static int decode_vop_header(Mpeg4DecContext *ctx, GetBitContext *gb)\n     return 0;\n }\n \n-static void read_quant_matrix_ext(MpegEncContext *s, GetBitContext *gb)\n+static int read_quant_matrix_ext(MpegEncContext *s, GetBitContext *gb)\n {\n     int i, j, v;\n \n     if (get_bits1(gb)) {\n+        if (get_bits_left(gb) < 64*8)\n+            return AVERROR_INVALIDDATA;\n         /* intra_quantiser_matrix */\n         for (i = 0; i < 64; i++) {\n             v = get_bits(gb, 8);\n@@ -2882,13 +2884,17 @@ static void read_quant_matrix_ext(MpegEncContext *s, GetBitContext *gb)\n     }\n \n     if (get_bits1(gb)) {\n+        if (get_bits_left(gb) < 64*8)\n+            return AVERROR_INVALIDDATA;\n         /* non_intra_quantiser_matrix */\n         for (i = 0; i < 64; i++) {\n             get_bits(gb, 8);\n         }\n     }\n \n     if (get_bits1(gb)) {\n+        if (get_bits_left(gb) < 64*8)\n+            return AVERROR_INVALIDDATA;\n         /* chroma_intra_quantiser_matrix */\n         for (i = 0; i < 64; i++) {\n             v = get_bits(gb, 8);\n@@ -2898,13 +2904,16 @@ static void read_quant_matrix_ext(MpegEncContext *s, GetBitContext *gb)\n     }\n \n     if (get_bits1(gb)) {\n+        if (get_bits_left(gb) < 64*8)\n+            return AVERROR_INVALIDDATA;\n         /* chroma_non_intra_quantiser_matrix */\n         for (i = 0; i < 64; i++) {\n             get_bits(gb, 8);\n         }\n     }\n \n     next_start_code_studio(gb);\n+    return 0;\n }\n \n static void extension_and_user_data(MpegEncContext *s, GetBitContext *gb, int id)"
    }
}