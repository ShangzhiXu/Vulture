{
    "current_hash": "9ccc633068c6fe76989f487c8932bd11886ad65b",
    "parent_hash": "d31940f04e864542819fb6b998d796e14305bd3c",
    "modified_file_0": {
        "mod_filename": "libavcodec/hevcdec.c",
        "status": "modified",
        "add_lines": 10,
        "dele_lines": 4,
        "patch": "@@ -472,6 +472,11 @@ static int hls_slice_header(HEVCContext *s)\n \n     // Coded parameters\n     sh->first_slice_in_pic_flag = get_bits1(gb);\n+    if (s->ref && sh->first_slice_in_pic_flag) {\n+        av_log(s->avctx, AV_LOG_ERROR, \"Two slices reporting being the first in the same frame.\\n\");\n+        return 1; // This slice will be skiped later, do not corrupt state\n+    }\n+\n     if ((IS_IDR(s) || IS_BLA(s)) && sh->first_slice_in_pic_flag) {\n         s->seq_decode = (s->seq_decode + 1) & 0xff;\n         s->max_ra     = INT_MAX;\n@@ -2862,12 +2867,13 @@ static int decode_nal_unit(HEVCContext *s, const H2645NAL *nal)\n         ret = hls_slice_header(s);\n         if (ret < 0)\n             return ret;\n+        if (ret == 1) {\n+            ret = AVERROR_INVALIDDATA;\n+            goto fail;\n+        }\n+\n \n         if (s->sh.first_slice_in_pic_flag) {\n-            if (s->ref) {\n-                av_log(s->avctx, AV_LOG_ERROR, \"Two slices reporting being the first in the same frame.\\n\");\n-                goto fail;\n-            }\n             if (s->max_ra == INT_MAX) {\n                 if (s->nal_unit_type == HEVC_NAL_CRA_NUT || IS_BLA(s)) {\n                     s->max_ra = s->poc;"
    }
}