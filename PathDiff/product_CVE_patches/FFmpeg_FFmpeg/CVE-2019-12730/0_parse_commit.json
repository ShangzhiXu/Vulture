{
    "current_hash": "ed188f6dcdf0935c939ed813cf8745d50742014b",
    "parent_hash": "9570322a2d8c122de3f1fa8079641950e01c5712",
    "modified_file_0": {
        "mod_filename": "libavformat/aadec.c",
        "status": "modified",
        "add_lines": 6,
        "dele_lines": 1,
        "patch": "@@ -85,6 +85,7 @@ static int aa_read_header(AVFormatContext *s)\n     AADemuxContext *c = s->priv_data;\n     AVIOContext *pb = s->pb;\n     AVStream *st;\n+    int ret;\n \n     /* parse .aa header */\n     avio_skip(pb, 4); // file size\n@@ -118,8 +119,12 @@ static int aa_read_header(AVFormatContext *s)\n             header_seed = atoi(val);\n         } else if (!strcmp(key, \"HeaderKey\")) { // this looks like \"1234567890 1234567890 1234567890 1234567890\"\n             av_log(s, AV_LOG_DEBUG, \"HeaderKey is <%s>\\n\", val);\n-            sscanf(val, \"%\"SCNu32\"%\"SCNu32\"%\"SCNu32\"%\"SCNu32,\n+\n+            ret = sscanf(val, \"%\"SCNu32\"%\"SCNu32\"%\"SCNu32\"%\"SCNu32,\n                    &header_key_part[0], &header_key_part[1], &header_key_part[2], &header_key_part[3]);\n+            if (ret != 4)\n+                return AVERROR_INVALIDDATA;\n+\n             for (idx = 0; idx < 4; idx++) {\n                 AV_WB32(&header_key[idx * 4], header_key_part[idx]); // convert each part to BE!\n             }"
    }
}