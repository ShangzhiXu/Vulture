{
    "current_hash": "23ccf3cabb4baf6e8af4b1af3fcc59c904736f21",
    "parent_hash": "abdbbe895838a55a404d54f7b26a4aca23d19577",
    "modified_file_0": {
        "mod_filename": "libavcodec/htmlsubtitles.c",
        "status": "modified",
        "add_lines": 29,
        "dele_lines": 1,
        "patch": "@@ -51,6 +51,34 @@ static void rstrip_spaces_buf(AVBPrint *buf)\n             buf->str[--buf->len] = 0;\n }\n \n+/*\n+ * Fast code for scanning the rest of a tag. Functionally equivalent to\n+ * this sscanf call:\n+ *\n+ * sscanf(in, \"%127[^<>]>%n\", buffer, lenp) == 2\n+ */\n+static int scantag(const char* in, char* buffer, int* lenp) {\n+    int len;\n+\n+    for (len = 0; len < 128; len++) {\n+        const char c = *in++;\n+        switch (c) {\n+        case '\\0':\n+            return 0;\n+        case '<':\n+            return 0;\n+        case '>':\n+            buffer[len] = '\\0';\n+            *lenp = len+1;\n+            return 1;\n+        default:\n+            break;\n+        }\n+        buffer[len] = c;\n+    }\n+    return 0;\n+}\n+\n int ff_htmlmarkup_to_ass(void *log_ctx, AVBPrint *dst, const char *in)\n {\n     char *param, buffer[128], tmp[128];\n@@ -102,7 +130,7 @@ int ff_htmlmarkup_to_ass(void *log_ctx, AVBPrint *dst, const char *in)\n         case '<':\n             tag_close = in[1] == '/';\n             len = 0;\n-            if (sscanf(in+tag_close+1, \"%127[^<>]>%n\", buffer, &len) >= 1 && len > 0) {\n+            if (scantag(in+tag_close+1, buffer, &len) && len > 0) {\n                 const char *tagname = buffer;\n                 while (*tagname == ' ')\n                     tagname++;"
    }
}