{
    "current_hash": "292e41ce650a7b5ca5de4ae87fff0d6a90d9fc97",
    "parent_hash": "654b21ef176a807bf4e8359a4ed52c629d766100",
    "modified_file_0": {
        "mod_filename": "libavcodec/tiff.c",
        "status": "modified",
        "add_lines": 5,
        "dele_lines": 2,
        "patch": "@@ -1923,14 +1923,17 @@ static int decode_frame(AVCodecContext *avctx,\n     has_strip_bits = s->strippos || s->strips || s->stripoff || s->rps || s->sot || s->sstype || s->stripsize || s->stripsizesoff;\n \n     if (has_tile_bits && has_strip_bits) {\n-        av_log(avctx, AV_LOG_WARNING, \"Tiled TIFF is not allowed to strip\\n\");\n+        int tiled_dng = s->is_tiled && is_dng;\n+        av_log(avctx, tiled_dng ? AV_LOG_WARNING : AV_LOG_ERROR, \"Tiled TIFF is not allowed to strip\\n\");\n+        if (!tiled_dng)\n+            return AVERROR_INVALIDDATA;\n     }\n \n     /* now we have the data and may start decoding */\n     if ((ret = init_image(s, &frame)) < 0)\n         return ret;\n \n-    if (!s->is_tiled) {\n+    if (!s->is_tiled || has_strip_bits) {\n         if (s->strips == 1 && !s->stripsize) {\n             av_log(avctx, AV_LOG_WARNING, \"Image data size missing\\n\");\n             s->stripsize = avpkt->size - s->stripoff;"
    }
}