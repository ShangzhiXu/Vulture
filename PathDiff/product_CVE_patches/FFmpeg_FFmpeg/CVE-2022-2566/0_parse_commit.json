{
    "current_hash": "c953baa084607dd1d84c3bfcce3cf6a87c3e6e05",
    "parent_hash": "ced0dc807eb67516b341d68f04ce5a87b02820de",
    "modified_file_0": {
        "mod_filename": "libavformat/mov.c",
        "status": "modified",
        "add_lines": 10,
        "dele_lines": 2,
        "patch": "@@ -3967,8 +3967,11 @@ static int build_open_gop_key_points(AVStream *st)\n \n     /* Build an unrolled index of the samples */\n     sc->sample_offsets_count = 0;\n-    for (uint32_t i = 0; i < sc->ctts_count; i++)\n+    for (uint32_t i = 0; i < sc->ctts_count; i++) {\n+        if (sc->ctts_data[i].count > INT_MAX - sc->sample_offsets_count)\n+            return AVERROR(ENOMEM);\n         sc->sample_offsets_count += sc->ctts_data[i].count;\n+    }\n     av_freep(&sc->sample_offsets);\n     sc->sample_offsets = av_calloc(sc->sample_offsets_count, sizeof(*sc->sample_offsets));\n     if (!sc->sample_offsets)\n@@ -3987,8 +3990,11 @@ static int build_open_gop_key_points(AVStream *st)\n     /* Build a list of open-GOP key samples */\n     sc->open_key_samples_count = 0;\n     for (uint32_t i = 0; i < sc->sync_group_count; i++)\n-        if (sc->sync_group[i].index == cra_index)\n+        if (sc->sync_group[i].index == cra_index) {\n+            if (sc->sync_group[i].count > INT_MAX - sc->open_key_samples_count)\n+                return AVERROR(ENOMEM);\n             sc->open_key_samples_count += sc->sync_group[i].count;\n+        }\n     av_freep(&sc->open_key_samples);\n     sc->open_key_samples = av_calloc(sc->open_key_samples_count, sizeof(*sc->open_key_samples));\n     if (!sc->open_key_samples)\n@@ -3999,6 +4005,8 @@ static int build_open_gop_key_points(AVStream *st)\n         if (sg->index == cra_index)\n             for (uint32_t j = 0; j < sg->count; j++)\n                 sc->open_key_samples[k++] = sample_id;\n+        if (sg->count > INT_MAX - sample_id)\n+            return AVERROR_PATCHWELCOME;\n         sample_id += sg->count;\n     }\n "
    }
}