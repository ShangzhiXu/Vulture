{
    "current_hash": "ff6db1027f8f36df657ff2e5ea167773752537ed",
    "parent_hash": "49efc80d342d8e8373c8af040580bd7940808730",
    "modified_file_0": {
        "mod_filename": "bgpd/bgp_packet.c",
        "status": "modified",
        "add_lines": 8,
        "dele_lines": 0,
        "patch": "@@ -2620,6 +2620,14 @@ static int bgp_capability_msg_parse(struct peer *peer, uint8_t *pnt,\n \t\t\t\t\"%s CAPABILITY has action: %d, code: %u, length %u\",\n \t\t\t\tpeer->host, action, hdr->code, hdr->length);\n \n+\t\tif (hdr->length < sizeof(struct capability_mp_data)) {\n+\t\t\tzlog_info(\n+\t\t\t\t\"%pBP Capability structure is not properly filled out, expected at least %zu bytes but header length specified is %d\",\n+\t\t\t\tpeer, sizeof(struct capability_mp_data),\n+\t\t\t\thdr->length);\n+\t\t\treturn BGP_Stop;\n+\t\t}\n+\n \t\t/* Capability length check. */\n \t\tif ((pnt + hdr->length + 3) > end) {\n \t\t\tzlog_info(\"%s Capability length error\", peer->host);"
    }
}