{
    "current_hash": "6903aebfddc466d966c7b865fae34572bf3ed23e",
    "parent_hash": "9ffb9bae63c8b7fbababb8481a83f1b575e59a18",
    "modified_file_0": {
        "mod_filename": "src/libopensc/pkcs15-oberthur.c",
        "status": "modified",
        "add_lines": 7,
        "dele_lines": 3,
        "patch": "@@ -271,11 +271,15 @@ sc_oberthur_read_file(struct sc_pkcs15_card *p15card, const char *in_path,\n \t\trv = sc_read_binary(card, 0, *out, sz, 0);\n \t}\n \telse\t{\n-\t\tint rec;\n-\t\tint offs = 0;\n-\t\tint rec_len = file->record_length;\n+\t\tsize_t rec;\n+\t\tsize_t offs = 0;\n+\t\tsize_t rec_len = file->record_length;\n \n \t\tfor (rec = 1; ; rec++)   {\n+\t\t\tif (rec > file->record_count) {\n+\t\t\t\trv = 0;\n+\t\t\t\tbreak;\n+\t\t\t}\n \t\t\trv = sc_read_record(card, rec, *out + offs + 2, rec_len, SC_RECORD_BY_REC_NR);\n \t\t\tif (rv == SC_ERROR_RECORD_NOT_FOUND)   {\n \t\t\t\trv = 0;"
    }
}