{
    "current_hash": "f015746d22d249642c19674298a18ad824db0ed7",
    "parent_hash": "78cdab949f098ad7e593d853229fccf57d749d0c",
    "modified_file_0": {
        "mod_filename": "src/libopensc/card-idprime.c",
        "status": "modified",
        "add_lines": 9,
        "dele_lines": 6,
        "patch": "@@ -418,6 +418,7 @@ static int idprime_get_token_name(sc_card_t* card, char** tname)\n \tsc_path_t tinfo_path = {\"\\x00\\x00\", 2, 0, 0, SC_PATH_TYPE_PATH, {\"\", 0}};\n \tsc_file_t *file = NULL;\n \tu8 buf[2];\n+\tchar *name;\n \tint r;\n \n \tLOG_FUNC_CALLED(card->ctx);\n@@ -445,20 +446,22 @@ static int idprime_get_token_name(sc_card_t* card, char** tname)\n \t}\n \tsc_file_free(file);\n \n-\t*tname = malloc(buf[1]);\n-\tif (*tname == NULL) {\n+\tname = malloc(buf[1]);\n+\tif (name == NULL) {\n \t\tLOG_FUNC_RETURN(card->ctx, SC_ERROR_OUT_OF_MEMORY);\n \t}\n \n-\tr = iso_ops->read_binary(card, 2, (unsigned char *)*tname, buf[1], 0);\n+\tr = iso_ops->read_binary(card, 2, (unsigned char *)name, buf[1], 0);\n \tif (r < 1) {\n-\t\tfree(*tname);\n+\t\tfree(name);\n \t\tLOG_FUNC_RETURN(card->ctx, r);\n \t}\n \n-\tif ((*tname)[r-1] != '\\0') {\n-\t\t(*tname)[r-1] = '\\0';\n+\tif (name[r-1] != '\\0') {\n+\t\tname[r-1] = '\\0';\n \t}\n+\t*tname = name;\n+\n \tLOG_FUNC_RETURN(card->ctx, SC_SUCCESS);\n }\n "
    }
}