{
    "current_hash": "05648b0604bf3e498e8d42dff3c6e7c56a5bf749",
    "parent_hash": "fc0df4e5d578e5926a59dbf3a34ce737424464ba",
    "modified_file_0": {
        "mod_filename": "src/libopensc/pkcs15-oberthur.c",
        "status": "modified",
        "add_lines": 4,
        "dele_lines": 2,
        "patch": "@@ -616,12 +616,14 @@ sc_pkcs15emu_oberthur_add_pubkey(struct sc_pkcs15_card *p15card,\n \toffs += 2 + len;\n \n \t/* ID */\n-\tif (offs > info_len) {\n+\tif (offs + 2 > info_len) {\n \t\tfree(info_blob);\n \t\tLOG_TEST_RET(ctx, SC_ERROR_UNKNOWN_DATA_RECEIVED, \"Failed to add public key: no 'ID'\");\n \t}\n \tlen = *(info_blob + offs + 1) + *(info_blob + offs) * 0x100;\n-\tif (!len || len > sizeof(key_info.id.value)) {\n+\tif (len == 0\n+\t\t\t|| len > sizeof(key_info.id.value)\n+\t\t\t|| offs + 2 + len > info_len) {\n \t\tfree(info_blob);\n \t\tLOG_TEST_RET(ctx, SC_ERROR_INVALID_DATA, \"Failed to add public key: invalid 'ID' length\");\n \t}"
    }
}