{
    "current_hash": "17d8980cde7be597afc366b7e311d0d7cadcb1f4",
    "parent_hash": "9c91a4327e6db579f7f964f147fd6e94a0e1b85e",
    "modified_file_0": {
        "mod_filename": "src/libopensc/pkcs15-oberthur.c",
        "status": "modified",
        "add_lines": 6,
        "dele_lines": 2,
        "patch": "@@ -884,12 +884,16 @@ sc_pkcs15emu_oberthur_add_data(struct sc_pkcs15_card *p15card,\n \toffs = 2;\n \n \t/* Label */\n-\tif (offs > info_len) {\n+\tif (offs + 2 > info_len) {\n \t\tfree(info_blob);\n \t\tLOG_TEST_RET(ctx, SC_ERROR_UNKNOWN_DATA_RECEIVED, \"Failed to add data: no 'label'\");\n \t}\n \tlabel = info_blob + offs + 2;\n \tlabel_len = *(info_blob + offs + 1) + *(info_blob + offs) * 0x100;\n+\tif (offs + 2 + label_len > info_len) {\n+\t\tfree(info_blob);\n+\t\tLOG_TEST_RET(ctx, SC_ERROR_UNKNOWN_DATA_RECEIVED, \"Invalid length of 'label' received\");\n+\t}\n \tif (label_len > sizeof(dobj.label) - 1)\n \t\tlabel_len = sizeof(dobj.label) - 1;\n \toffs += 2 + *(info_blob + offs + 1);\n@@ -906,7 +910,7 @@ sc_pkcs15emu_oberthur_add_data(struct sc_pkcs15_card *p15card,\n \toffs += 2 + app_len;\n \n \t/* OID encode like DER(ASN.1(oid)) */\n-\tif (offs > info_len) {\n+\tif (offs + 1 > info_len) {\n \t\tfree(info_blob);\n \t\tLOG_TEST_RET(ctx, SC_ERROR_UNKNOWN_DATA_RECEIVED, \"Failed to add data: no 'OID'\");\n \t}"
    }
}