{
    "current_hash": "5d4daf6c92e4668f5458f380f3cacea3e879d91a",
    "parent_hash": "715c17c469f6c463dd511a5deb229da4de9ee100",
    "modified_file_0": {
        "mod_filename": "src/libopensc/pkcs15-oberthur.c",
        "status": "modified",
        "add_lines": 4,
        "dele_lines": 1,
        "patch": "@@ -609,7 +609,10 @@ sc_pkcs15emu_oberthur_add_pubkey(struct sc_pkcs15_card *p15card,\n \t\tLOG_TEST_RET(ctx, SC_ERROR_UNKNOWN_DATA_RECEIVED, \"Failed to add public key: no 'Label'\");\n \t}\n \tlen = *(info_blob + offs + 1) + *(info_blob + offs) * 0x100;\n-\tif (len)   {\n+\tif (offs + 2 + len > info_len) {\n+\t\tfree(info_blob);\n+\t\tLOG_TEST_RET(ctx, SC_ERROR_INVALID_DATA, \"Failed to add public key: invalid 'Label' length\");\n+\t} else if (len) {\n \t\tif (len > sizeof(key_obj.label) - 1)\n \t\t\tlen = sizeof(key_obj.label) - 1;\n \t\tmemcpy(key_obj.label, info_blob + offs + 2, len);"
    }
}