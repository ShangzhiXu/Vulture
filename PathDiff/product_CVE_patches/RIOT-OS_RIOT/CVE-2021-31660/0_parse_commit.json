{
    "current_hash": "85da504d2dc30188b89f44c3276fc5a25b31251f",
    "parent_hash": "ffdddc802e5edf6892a76beb79a0a2c893df3222",
    "modified_file_0": {
        "mod_filename": "sys/clif/clif.c",
        "status": "modified",
        "add_lines": 4,
        "dele_lines": 0,
        "patch": "@@ -258,6 +258,10 @@ ssize_t clif_get_attr(const char *input, size_t input_len, clif_attr_t *attr)\n     attr->value = NULL;\n     attr->key = NULL;\n \n+    if (input_len == 0) {\n+        return CLIF_NOT_FOUND;\n+    }\n+\n     /* an attribute should start with the separator */\n     if (*pos != LF_ATTR_SEPARATOR_C) {\n         DEBUG(\"Attribute should start with separator, found %c\\n\", *pos);"
    },
    "modified_file_1": {
        "mod_filename": "tests/unittests/tests-clif/tests-clif.c",
        "status": "modified",
        "add_lines": 11,
        "dele_lines": 0,
        "patch": "@@ -285,12 +285,23 @@ static void test_clif_get_attr_missing_value(void)\n     TEST_ASSERT_EQUAL_INT(strlen(input), r);\n }\n \n+static void test_clif_get_attr_empty(void)\n+{\n+    clif_attr_t attr;\n+\n+    /* clif_get_attr used to access data even if input was empty.\n+     * See: https://github.com/RIOT-OS/RIOT/pull/15947 */\n+    int r = clif_get_attr(NULL, 0, &attr);\n+    TEST_ASSERT_EQUAL_INT(CLIF_NOT_FOUND, r);\n+}\n+\n Test *tests_clif_tests(void)\n {\n     EMB_UNIT_TESTFIXTURES(fixtures) {\n         new_TestFixture(test_clif_encode_links),\n         new_TestFixture(test_clif_decode_links),\n         new_TestFixture(test_clif_get_attr_missing_value),\n+        new_TestFixture(test_clif_get_attr_empty)\n     };\n \n     EMB_UNIT_TESTCALLER(clif_tests, NULL, NULL, fixtures);"
    }
}