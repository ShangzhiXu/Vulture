{
    "current_hash": "890c3f850293176c0e996a602ffa88b315f4e98f",
    "parent_hash": "eb491e03851a11bc811173f5e13c89cefa7257ac",
    "modified_file_0": {
        "mod_filename": "libyara/grammar.c",
        "status": "modified",
        "add_lines": 327,
        "dele_lines": 318,
        "patch": "@@ -546,16 +546,16 @@ union yyalloc\n /* YYFINAL -- State number of the termination state.  */\n #define YYFINAL  2\n /* YYLAST -- Last index in YYTABLE.  */\n-#define YYLAST   408\n+#define YYLAST   406\n \n /* YYNTOKENS -- Number of terminals.  */\n #define YYNTOKENS  72\n /* YYNNTS -- Number of nonterminals.  */\n #define YYNNTS  41\n /* YYNRULES -- Number of rules.  */\n-#define YYNRULES  121\n+#define YYNRULES  122\n /* YYNSTATES -- Number of states.  */\n-#define YYNSTATES  209\n+#define YYNSTATES  210\n \n /* YYTRANSLATE[YYX] -- Symbol number corresponding to YYX as returned\n    by yylex, with out-of-bounds checking.  */\n@@ -612,13 +612,13 @@ static const yytype_uint16 yyrline[] =\n      472,   485,   502,   503,   509,   508,   524,   523,   539,   553,\n      554,   559,   560,   561,   562,   567,   652,   698,   756,   801,\n      802,   806,   831,   867,   913,   935,   944,   953,   968,   980,\n-     994,  1007,  1019,  1049,  1018,  1163,  1162,  1241,  1247,  1254,\n-    1253,  1316,  1315,  1376,  1385,  1394,  1403,  1412,  1421,  1430,\n-    1434,  1442,  1443,  1448,  1470,  1482,  1498,  1497,  1503,  1514,\n-    1515,  1520,  1527,  1538,  1539,  1543,  1551,  1555,  1565,  1579,\n-    1595,  1605,  1614,  1639,  1651,  1663,  1679,  1691,  1707,  1752,\n-    1771,  1789,  1807,  1825,  1851,  1869,  1879,  1889,  1899,  1909,\n-    1919,  1929\n+     994,  1007,  1018,  1024,  1054,  1023,  1168,  1167,  1246,  1252,\n+    1259,  1258,  1321,  1320,  1381,  1390,  1399,  1408,  1417,  1426,\n+    1435,  1439,  1447,  1448,  1453,  1475,  1487,  1503,  1502,  1508,\n+    1519,  1520,  1525,  1532,  1543,  1544,  1548,  1556,  1560,  1570,\n+    1584,  1600,  1610,  1619,  1644,  1656,  1668,  1684,  1696,  1712,\n+    1757,  1776,  1794,  1812,  1830,  1856,  1874,  1884,  1894,  1904,\n+    1914,  1924,  1934\n };\n #endif\n \n@@ -672,7 +672,7 @@ static const yytype_uint16 yytoknum[] =\n #define yypact_value_is_default(Yystate) \\\n   (!!((Yystate) == (-73)))\n \n-#define YYTABLE_NINF -94\n+#define YYTABLE_NINF -95\n \n #define yytable_value_is_error(Yytable_value) \\\n   0\n@@ -681,27 +681,27 @@ static const yytype_uint16 yytoknum[] =\n      STATE-NUM.  */\n static const yytype_int16 yypact[] =\n {\n-     -73,    79,   -73,   -32,    -4,   -73,   -73,    94,   -73,   -73,\n-     -73,   -73,    13,   -73,   -73,   -73,   -73,    -8,    72,     6,\n-     -73,    78,   111,   -73,    61,   122,   123,    82,   -73,    90,\n-     123,   -73,   147,   150,    16,   -73,    96,   147,   -73,   101,\n-      97,   -73,   -73,   -73,   -73,   151,    53,   -73,    48,   -73,\n-     -73,   -73,   149,   145,   -73,    -9,   -73,   103,   107,   -73,\n-     -73,   106,   -73,   -73,   -73,   -73,   -73,   -73,   110,   -73,\n-     -73,   135,    48,   135,    48,   -33,   -73,    64,   -73,   144,\n-     306,   -73,   -73,   135,   108,   135,   135,   135,   135,    -7,\n-     322,   -73,   -73,   -73,    64,   117,   163,   168,   135,    48,\n-     -73,   -73,    -6,   167,   135,   135,   135,   135,   135,   135,\n-     135,   135,   135,   135,   135,   135,   135,   135,   135,   135,\n-     135,    86,    86,   322,   135,   -73,   243,   261,   183,   203,\n-     159,    -6,   -73,   -73,   -73,   279,   121,   125,    95,    48,\n-      48,   -73,   -73,   -73,   -73,   322,   337,   351,   -43,   322,\n-     322,   322,   322,   322,   322,    40,    40,    58,    58,   -73,\n-     -73,   -73,   -73,   -73,   -73,   -73,   -73,   129,   -73,   -73,\n-     -73,   -73,   128,   -73,   -73,    48,   152,   -73,    15,   135,\n-     131,   -73,    95,   -73,   -73,    71,   -73,   223,   135,   133,\n-     -73,   132,   -73,    15,   -73,    73,   129,   -73,    48,   -73,\n-     -73,   135,   134,    31,   322,    48,   -73,    49,   -73\n+     -73,    90,   -73,   -32,   -10,   -73,   -73,    93,   -73,   -73,\n+     -73,   -73,     1,   -73,   -73,   -73,   -73,   -49,     7,   -36,\n+     -73,    20,    26,   -73,   -28,    92,    46,     4,   -73,    40,\n+      46,   -73,   100,   119,    16,   -73,    72,   100,   -73,    77,\n+      83,   -73,   -73,   -73,   -73,   134,    59,   -73,    48,   -73,\n+     -73,   -73,   133,   136,   -73,   -18,   -73,    88,    95,   -73,\n+     -73,    91,   -73,   -73,   -73,   -73,   -73,   -73,   102,   -73,\n+     -73,   126,    48,   126,    48,   -44,   -73,    85,   -73,   127,\n+     297,   -73,   -73,   126,   110,   126,   126,   126,   126,     2,\n+     313,   -73,   -73,   -73,    85,   111,   154,   172,   126,    48,\n+     -73,   -73,    -6,   162,   126,   126,   126,   126,   126,   126,\n+     126,   126,   126,   126,   126,   126,   126,   126,   126,   126,\n+     126,    60,    60,   313,   126,   -73,   234,   252,   174,   194,\n+     -73,   153,    -6,   -73,   -73,   -73,   270,   117,   120,   108,\n+      48,    48,   -73,   -73,   -73,   -73,   313,   328,   342,   349,\n+     313,   313,   313,   313,   313,   313,   113,   113,    53,    53,\n+     -73,   -73,   -73,   -73,   -73,   -73,   -73,   -73,   121,   -73,\n+     -73,   -73,   -73,   124,   -73,   -73,    48,   151,   -73,    -1,\n+     126,   125,   -73,   108,   -73,   -73,    18,   -73,   214,   126,\n+     129,   -73,   143,   -73,    -1,   -73,    63,   121,   -73,    48,\n+     -73,   -73,   126,   144,    31,   313,    48,   -73,    33,   -73\n };\n \n   /* YYDEFACT[STATE-NUM] -- Default reduction number in state STATE-NUM.\n@@ -714,31 +714,31 @@ static const yytype_uint8 yydefact[] =\n       23,    22,    12,    24,     0,    14,     0,     0,    10,     0,\n       13,    25,     0,     0,     0,    26,     0,    15,    32,     0,\n        0,    28,    27,    30,    31,     0,    34,    33,     0,    11,\n-      29,    38,     0,     0,    45,    59,   103,   105,   107,   100,\n-     101,     0,   102,    53,    97,    98,    94,    95,     0,    55,\n-      56,     0,     0,     0,     0,   108,   121,    16,    54,     0,\n-      79,    39,    39,     0,     0,     0,     0,     0,     0,     0,\n-      93,   109,    68,   118,     0,    54,    79,     0,     0,    49,\n-      71,    69,     0,     0,     0,     0,     0,     0,     0,     0,\n+      29,    38,     0,     0,    45,    59,   104,   106,   108,   101,\n+     102,     0,   103,    53,    98,    99,    95,    96,     0,    55,\n+      56,     0,     0,     0,     0,   109,   122,    16,    54,     0,\n+      80,    39,    39,     0,     0,     0,     0,     0,     0,     0,\n+      94,   110,    69,   119,     0,    54,    80,     0,     0,    49,\n+      72,    70,     0,     0,     0,     0,     0,     0,     0,     0,\n        0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n        0,    35,    37,    60,     0,    61,     0,     0,     0,     0,\n-       0,     0,    80,    96,    46,     0,     0,    50,    51,     0,\n-       0,    88,    86,    67,    57,    58,   117,   115,   116,    77,\n-      78,    73,    75,    74,    76,   119,   120,   110,   111,   112,\n-     113,   114,    42,    41,    43,    44,    40,     0,   104,   106,\n-      99,    62,     0,    47,    48,     0,    72,    70,     0,     0,\n-       0,    65,    52,    91,    92,     0,    89,     0,     0,     0,\n-      82,     0,    87,     0,    83,     0,    84,    63,     0,    90,\n-      81,     0,     0,     0,    85,     0,    66,     0,    64\n+      62,     0,     0,    81,    97,    46,     0,     0,    50,    51,\n+       0,     0,    89,    87,    68,    57,    58,   118,   116,   117,\n+      78,    79,    74,    76,    75,    77,   120,   121,   111,   112,\n+     113,   114,   115,    42,    41,    43,    44,    40,     0,   105,\n+     107,   100,    63,     0,    47,    48,     0,    73,    71,     0,\n+       0,     0,    66,    52,    92,    93,     0,    90,     0,     0,\n+       0,    83,     0,    88,     0,    84,     0,    85,    64,     0,\n+      91,    82,     0,     0,     0,    86,     0,    67,     0,    65\n };\n \n   /* YYPGOTO[NTERM-NUM].  */\n static const yytype_int16 yypgoto[] =\n {\n-     -73,   -73,   199,   218,   -73,   -73,   -73,   -73,   -73,   -73,\n-     -73,   -73,   -73,   -73,   192,   -73,   186,   -73,   -73,   142,\n-     -73,   -73,   -73,   -73,   126,   -48,   -72,   -73,   -73,   -73,\n-     -73,   -73,   -73,    50,   -73,   100,   -73,   -73,    35,   164,\n+     -73,   -73,   211,   212,   -73,   -73,   -73,   -73,   -73,   -73,\n+     -73,   -73,   -73,   -73,   189,   -73,   183,   -73,   -73,   139,\n+     -73,   -73,   -73,   -73,   130,   -48,   -72,   -73,   -73,   -73,\n+     -73,   -73,   -73,    41,   -73,   103,   -73,   -73,    29,   164,\n      -67\n };\n \n@@ -747,8 +747,8 @@ static const yytype_int16 yydefgoto[] =\n {\n       -1,     1,     5,     6,    17,    33,    25,    28,    40,     7,\n       15,    19,    21,    30,    31,    37,    38,    52,    53,   121,\n-     166,    75,   136,   137,    76,    94,    78,   180,   202,   191,\n-     140,   139,   189,   125,   195,   143,   178,   185,   186,    79,\n+     167,    75,   137,   138,    76,    94,    78,   181,   203,   192,\n+     141,   140,   190,   125,   196,   144,   179,   186,   187,    79,\n       80\n };\n \n@@ -757,92 +757,92 @@ static const yytype_int16 yydefgoto[] =\n      number is the opposite.  If YYTABLE_NINF, syntax error.  */\n static const yytype_int16 yytable[] =\n {\n-      77,    90,    95,   130,    91,     4,    93,    96,   114,   115,\n-     116,   117,   118,   119,   120,    11,   123,    83,   126,   127,\n-     128,   129,    84,    16,    92,   131,   183,   138,   141,     8,\n-     184,   135,    41,    97,    98,    42,    99,   145,   146,   147,\n-     148,   149,   150,   151,   152,   153,   154,   155,   156,   157,\n-     158,   159,   160,   161,    43,    44,    18,   167,    54,    55,\n-      56,    57,    58,   142,    59,    60,    61,    62,    22,    63,\n-      45,   100,   101,    51,   -36,    64,    65,    66,    67,     2,\n-       3,    68,    20,   -17,   -17,   -17,    69,    70,    23,   100,\n-     101,   176,   177,   116,   117,   118,   119,   120,    12,    13,\n-      14,   206,    71,   182,   100,   101,    72,    73,   162,   163,\n-     164,   165,   187,   118,   119,   120,     4,    74,    24,   208,\n-      54,   196,    56,    57,    58,    26,    59,    60,    61,    62,\n-      27,    63,   179,    29,   204,   -54,   -54,    64,    65,    66,\n-      67,   192,   193,   200,   201,    54,    32,    56,    57,    58,\n-     203,    59,    60,    61,    62,    34,    63,   207,    36,    39,\n-      49,    46,    64,    65,    71,    48,    82,    50,    81,    73,\n-      85,   105,   106,   107,    86,    87,   102,   124,   134,    88,\n-     114,   115,   116,   117,   118,   119,   120,   132,    63,    71,\n-     171,   174,   181,   101,    73,   -93,   175,   197,   103,   104,\n-     188,   198,     9,   205,    88,   105,   106,   107,   108,   109,\n-     110,   111,   112,   113,   114,   115,   116,   117,   118,   119,\n-     120,    10,    35,    47,   122,   105,   106,   107,   199,   144,\n-     190,   172,    89,   133,   114,   115,   116,   117,   118,   119,\n-     120,     0,     0,     0,     0,   105,   106,   107,     0,     0,\n-       0,     0,     0,   170,   114,   115,   116,   117,   118,   119,\n-     120,     0,     0,     0,     0,   105,   106,   107,     0,     0,\n-       0,     0,     0,   133,   114,   115,   116,   117,   118,   119,\n-     120,     0,     0,     0,     0,   105,   106,   107,     0,     0,\n-       0,     0,     0,   194,   114,   115,   116,   117,   118,   119,\n-     120,     0,     0,   105,   106,   107,     0,     0,     0,     0,\n-       0,   168,   114,   115,   116,   117,   118,   119,   120,     0,\n-       0,   105,   106,   107,     0,     0,     0,     0,     0,   169,\n-     114,   115,   116,   117,   118,   119,   120,     0,   -93,     0,\n-       0,   103,   104,     0,     0,     0,     0,   173,   105,   106,\n-     107,   108,   109,   110,   111,   112,   113,   114,   115,   116,\n-     117,   118,   119,   120,   105,   106,   107,     0,     0,     0,\n+      77,    90,    95,   130,    91,     4,    93,    96,    83,    11,\n+     184,    16,   131,    84,   185,    18,   123,    20,   126,   127,\n+     128,   129,    97,    98,    92,    99,    22,   139,   142,     8,\n+      23,   136,    41,    24,   132,    42,    26,   146,   147,   148,\n+     149,   150,   151,   152,   153,   154,   155,   156,   157,   158,\n+     159,   160,   161,   162,    43,    44,    29,   168,    54,    55,\n+      56,    57,    58,   143,    59,    60,    61,    62,    32,    63,\n+      45,   100,   101,   100,   101,    64,    65,    66,    67,    51,\n+     -36,    68,   163,   164,   165,   166,    69,    70,   193,   194,\n+       2,     3,   177,   178,   -17,   -17,   -17,    12,    13,    14,\n+      27,   207,    71,   209,   183,    34,    72,    73,   118,   119,\n+     120,    36,    54,   188,    56,    57,    58,    74,    59,    60,\n+      61,    62,   197,    63,   180,   100,   101,     4,    39,    64,\n+      65,    66,    67,   201,   202,   205,    54,    46,    56,    57,\n+      58,    48,    59,    60,    61,    62,    49,    63,   -54,   -54,\n+      50,   204,    81,    64,    65,    85,    71,    82,   208,   102,\n+      87,    73,    86,   105,   106,   107,   116,   117,   118,   119,\n+     120,    88,   114,   115,   116,   117,   118,   119,   120,   124,\n+      71,   133,   135,    63,   172,    73,   -94,   175,   182,   103,\n+     104,   176,   101,   198,   189,    88,   105,   106,   107,   108,\n+     109,   110,   111,   112,   113,   114,   115,   116,   117,   118,\n+     119,   120,   199,   206,     9,    10,   105,   106,   107,    35,\n+      47,   122,   191,   200,   134,   114,   115,   116,   117,   118,\n+     119,   120,    89,   145,     0,   173,   105,   106,   107,     0,\n+       0,     0,     0,     0,   171,   114,   115,   116,   117,   118,\n+     119,   120,     0,     0,     0,     0,   105,   106,   107,     0,\n+       0,     0,     0,     0,   134,   114,   115,   116,   117,   118,\n+     119,   120,     0,     0,     0,     0,   105,   106,   107,     0,\n+       0,     0,     0,     0,   195,   114,   115,   116,   117,   118,\n+     119,   120,     0,     0,   105,   106,   107,     0,     0,     0,\n+       0,     0,   169,   114,   115,   116,   117,   118,   119,   120,\n+       0,     0,   105,   106,   107,     0,     0,     0,     0,     0,\n+     170,   114,   115,   116,   117,   118,   119,   120,     0,   -94,\n+       0,     0,   103,   104,     0,     0,     0,     0,   174,   105,\n+     106,   107,   108,   109,   110,   111,   112,   113,   114,   115,\n+     116,   117,   118,   119,   120,   105,   106,   107,     0,     0,\n+       0,     0,     0,     0,   114,   115,   116,   117,   118,   119,\n+     120,   106,   107,     0,     0,     0,     0,     0,     0,   114,\n+     115,   116,   117,   118,   119,   120,   107,     0,     0,     0,\n        0,     0,     0,   114,   115,   116,   117,   118,   119,   120,\n-     106,   107,     0,     0,     0,     0,     0,     0,   114,   115,\n-     116,   117,   118,   119,   120,   107,     0,     0,     0,     0,\n-       0,     0,   114,   115,   116,   117,   118,   119,   120\n+     114,   115,   116,   117,   118,   119,   120\n };\n \n static const yytype_int16 yycheck[] =\n {\n-      48,    68,    74,    10,    71,    37,    73,    74,    51,    52,\n-      53,    54,    55,    56,    57,    19,    83,    26,    85,    86,\n-      87,    88,    31,    10,    72,    32,    11,    99,    34,    61,\n-      15,    98,    16,    66,    67,    19,    69,   104,   105,   106,\n+      48,    68,    74,     1,    71,    37,    73,    74,    26,    19,\n+      11,    10,    10,    31,    15,    64,    83,    10,    85,    86,\n+      87,    88,    66,    67,    72,    69,    62,    99,    34,    61,\n+      10,    98,    16,     7,    32,    19,    64,   104,   105,   106,\n      107,   108,   109,   110,   111,   112,   113,   114,   115,   116,\n-     117,   118,   119,   120,    38,    39,    64,   124,    10,    11,\n-      12,    13,    14,    69,    16,    17,    18,    19,    62,    21,\n-      54,    40,    41,    20,    21,    27,    28,    29,    30,     0,\n-       1,    33,    10,     4,     5,     6,    38,    39,    10,    40,\n-      41,   139,   140,    53,    54,    55,    56,    57,     4,     5,\n-       6,    70,    54,   175,    40,    41,    58,    59,    22,    23,\n-      24,    25,   179,    55,    56,    57,    37,    69,     7,    70,\n-      10,   188,    12,    13,    14,    64,    16,    17,    18,    19,\n-       8,    21,     3,    10,   201,    40,    41,    27,    28,    29,\n-      30,    70,    71,    70,    71,    10,    64,    12,    13,    14,\n-     198,    16,    17,    18,    19,    65,    21,   205,    11,     9,\n-      63,    65,    27,    28,    54,    64,    21,    16,    19,    59,\n-      67,    42,    43,    44,    67,    69,    32,    69,    10,    69,\n-      51,    52,    53,    54,    55,    56,    57,    70,    21,    54,\n-      31,    70,    64,    41,    59,    32,    71,    64,    35,    36,\n-      69,    69,     3,    69,    69,    42,    43,    44,    45,    46,\n-      47,    48,    49,    50,    51,    52,    53,    54,    55,    56,\n-      57,     3,    30,    37,    82,    42,    43,    44,   193,   103,\n-     180,   131,    68,    70,    51,    52,    53,    54,    55,    56,\n-      57,    -1,    -1,    -1,    -1,    42,    43,    44,    -1,    -1,\n-      -1,    -1,    -1,    70,    51,    52,    53,    54,    55,    56,\n-      57,    -1,    -1,    -1,    -1,    42,    43,    44,    -1,    -1,\n-      -1,    -1,    -1,    70,    51,    52,    53,    54,    55,    56,\n-      57,    -1,    -1,    -1,    -1,    42,    43,    44,    -1,    -1,\n-      -1,    -1,    -1,    70,    51,    52,    53,    54,    55,    56,\n-      57,    -1,    -1,    42,    43,    44,    -1,    -1,    -1,    -1,\n-      -1,    68,    51,    52,    53,    54,    55,    56,    57,    -1,\n-      -1,    42,    43,    44,    -1,    -1,    -1,    -1,    -1,    68,\n-      51,    52,    53,    54,    55,    56,    57,    -1,    32,    -1,\n-      -1,    35,    36,    -1,    -1,    -1,    -1,    68,    42,    43,\n-      44,    45,    46,    47,    48,    49,    50,    51,    52,    53,\n-      54,    55,    56,    57,    42,    43,    44,    -1,    -1,    -1,\n+     117,   118,   119,   120,    38,    39,    10,   124,    10,    11,\n+      12,    13,    14,    69,    16,    17,    18,    19,    64,    21,\n+      54,    40,    41,    40,    41,    27,    28,    29,    30,    20,\n+      21,    33,    22,    23,    24,    25,    38,    39,    70,    71,\n+       0,     1,   140,   141,     4,     5,     6,     4,     5,     6,\n+       8,    70,    54,    70,   176,    65,    58,    59,    55,    56,\n+      57,    11,    10,   180,    12,    13,    14,    69,    16,    17,\n+      18,    19,   189,    21,     3,    40,    41,    37,     9,    27,\n+      28,    29,    30,    70,    71,   202,    10,    65,    12,    13,\n+      14,    64,    16,    17,    18,    19,    63,    21,    40,    41,\n+      16,   199,    19,    27,    28,    67,    54,    21,   206,    32,\n+      69,    59,    67,    42,    43,    44,    53,    54,    55,    56,\n+      57,    69,    51,    52,    53,    54,    55,    56,    57,    69,\n+      54,    70,    10,    21,    31,    59,    32,    70,    64,    35,\n+      36,    71,    41,    64,    69,    69,    42,    43,    44,    45,\n+      46,    47,    48,    49,    50,    51,    52,    53,    54,    55,\n+      56,    57,    69,    69,     3,     3,    42,    43,    44,    30,\n+      37,    82,   181,   194,    70,    51,    52,    53,    54,    55,\n+      56,    57,    68,   103,    -1,   132,    42,    43,    44,    -1,\n+      -1,    -1,    -1,    -1,    70,    51,    52,    53,    54,    55,\n+      56,    57,    -1,    -1,    -1,    -1,    42,    43,    44,    -1,\n+      -1,    -1,    -1,    -1,    70,    51,    52,    53,    54,    55,\n+      56,    57,    -1,    -1,    -1,    -1,    42,    43,    44,    -1,\n+      -1,    -1,    -1,    -1,    70,    51,    52,    53,    54,    55,\n+      56,    57,    -1,    -1,    42,    43,    44,    -1,    -1,    -1,\n+      -1,    -1,    68,    51,    52,    53,    54,    55,    56,    57,\n+      -1,    -1,    42,    43,    44,    -1,    -1,    -1,    -1,    -1,\n+      68,    51,    52,    53,    54,    55,    56,    57,    -1,    32,\n+      -1,    -1,    35,    36,    -1,    -1,    -1,    -1,    68,    42,\n+      43,    44,    45,    46,    47,    48,    49,    50,    51,    52,\n+      53,    54,    55,    56,    57,    42,    43,    44,    -1,    -1,\n+      -1,    -1,    -1,    -1,    51,    52,    53,    54,    55,    56,\n+      57,    43,    44,    -1,    -1,    -1,    -1,    -1,    -1,    51,\n+      52,    53,    54,    55,    56,    57,    44,    -1,    -1,    -1,\n       -1,    -1,    -1,    51,    52,    53,    54,    55,    56,    57,\n-      43,    44,    -1,    -1,    -1,    -1,    -1,    -1,    51,    52,\n-      53,    54,    55,    56,    57,    44,    -1,    -1,    -1,    -1,\n-      -1,    -1,    51,    52,    53,    54,    55,    56,    57\n+      51,    52,    53,    54,    55,    56,    57\n };\n \n   /* YYSTOS[STATE-NUM] -- The (internal number of the) accessing\n@@ -862,14 +862,14 @@ static const yytype_uint8 yystos[] =\n       40,    41,    32,    35,    36,    42,    43,    44,    45,    46,\n       47,    48,    49,    50,    51,    52,    53,    54,    55,    56,\n       57,    91,    91,   112,    69,   105,   112,   112,   112,   112,\n-      10,    32,    70,    70,    10,   112,    94,    95,    98,   103,\n-     102,    34,    69,   107,    96,   112,   112,   112,   112,   112,\n+       1,    10,    32,    70,    70,    10,   112,    94,    95,    98,\n+     103,   102,    34,    69,   107,    96,   112,   112,   112,   112,\n      112,   112,   112,   112,   112,   112,   112,   112,   112,   112,\n-     112,   112,    22,    23,    24,    25,    92,   112,    68,    68,\n-      70,    31,   107,    68,    70,    71,    97,    97,   108,     3,\n-      99,    64,    98,    11,    15,   109,   110,   112,    69,   104,\n-     105,   101,    70,    71,    70,   106,   112,    64,    69,   110,\n-      70,    71,   100,    97,   112,    69,    70,    97,    70\n+     112,   112,   112,    22,    23,    24,    25,    92,   112,    68,\n+      68,    70,    31,   107,    68,    70,    71,    97,    97,   108,\n+       3,    99,    64,    98,    11,    15,   109,   110,   112,    69,\n+     104,   105,   101,    70,    71,    70,   106,   112,    64,    69,\n+     110,    70,    71,   100,    97,   112,    69,    70,    97,    70\n };\n \n   /* YYR1[YYN] -- Symbol number of symbol that rule YYN derives.  */\n@@ -881,13 +881,13 @@ static const yytype_uint8 yyr1[] =\n       86,    86,    87,    87,    89,    88,    90,    88,    88,    91,\n       91,    92,    92,    92,    92,    93,    93,    93,    93,    94,\n       94,    95,    95,    96,    97,    98,    98,    98,    98,    98,\n-      98,    98,    99,   100,    98,   101,    98,    98,    98,   102,\n-      98,   103,    98,    98,    98,    98,    98,    98,    98,    98,\n-      98,   104,   104,   105,   106,   106,   108,   107,   107,   109,\n-     109,   110,   110,   111,   111,   111,   112,   112,   112,   112,\n+      98,    98,    98,    99,   100,    98,   101,    98,    98,    98,\n+     102,    98,   103,    98,    98,    98,    98,    98,    98,    98,\n+      98,    98,   104,   104,   105,   106,   106,   108,   107,   107,\n+     109,   109,   110,   110,   111,   111,   111,   112,   112,   112,\n      112,   112,   112,   112,   112,   112,   112,   112,   112,   112,\n      112,   112,   112,   112,   112,   112,   112,   112,   112,   112,\n-     112,   112\n+     112,   112,   112\n };\n \n   /* YYR2[YYN] -- Number of symbols on the right hand side of rule YYN.  */\n@@ -899,13 +899,13 @@ static const yytype_uint8 yyr2[] =\n        3,     3,     1,     2,     0,     5,     0,     5,     3,     0,\n        2,     1,     1,     1,     1,     1,     3,     4,     4,     0,\n        1,     1,     3,     1,     1,     1,     1,     3,     3,     1,\n-       3,     3,     0,     0,    11,     0,     9,     3,     2,     0,\n-       4,     0,     4,     3,     3,     3,     3,     3,     3,     1,\n-       3,     3,     1,     5,     1,     3,     0,     4,     1,     1,\n-       3,     1,     1,     1,     1,     1,     3,     1,     1,     4,\n-       1,     1,     1,     1,     4,     1,     4,     1,     1,     2,\n-       3,     3,     3,     3,     3,     3,     3,     3,     2,     3,\n-       3,     1\n+       3,     3,     3,     0,     0,    11,     0,     9,     3,     2,\n+       0,     4,     0,     4,     3,     3,     3,     3,     3,     3,\n+       1,     3,     3,     1,     5,     1,     3,     0,     4,     1,\n+       1,     3,     1,     1,     1,     1,     1,     3,     1,     1,\n+       4,     1,     1,     1,     1,     4,     1,     4,     1,     1,\n+       2,     3,     3,     3,     3,     3,     3,     3,     3,     2,\n+       3,     3,     1\n };\n \n \n@@ -2586,6 +2586,15 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n   case 62:\n #line 1019 \"grammar.y\" /* yacc.c:1646  */\n+    {\n+        compiler->loop_depth--;\n+        compiler->loop_identifier[compiler->loop_depth] = NULL;\n+      }\n+#line 2594 \"grammar.c\" /* yacc.c:1646  */\n+    break;\n+\n+  case 63:\n+#line 1024 \"grammar.y\" /* yacc.c:1646  */\n     {\n         int var_index;\n \n@@ -2615,11 +2624,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n         ERROR_IF(compiler->last_result != ERROR_SUCCESS);\n       }\n-#line 2619 \"grammar.c\" /* yacc.c:1646  */\n+#line 2628 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 63:\n-#line 1049 \"grammar.y\" /* yacc.c:1646  */\n+  case 64:\n+#line 1054 \"grammar.y\" /* yacc.c:1646  */\n     {\n         int mem_offset = LOOP_LOCAL_VARS * compiler->loop_depth;\n         uint8_t* addr;\n@@ -2654,11 +2663,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         compiler->loop_identifier[compiler->loop_depth] = (yyvsp[-4].c_string);\n         compiler->loop_depth++;\n       }\n-#line 2658 \"grammar.c\" /* yacc.c:1646  */\n+#line 2667 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 64:\n-#line 1084 \"grammar.y\" /* yacc.c:1646  */\n+  case 65:\n+#line 1089 \"grammar.y\" /* yacc.c:1646  */\n     {\n         int mem_offset;\n \n@@ -2737,11 +2746,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n         (yyval.expression).type = EXPRESSION_TYPE_BOOLEAN;\n       }\n-#line 2741 \"grammar.c\" /* yacc.c:1646  */\n+#line 2750 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 65:\n-#line 1163 \"grammar.y\" /* yacc.c:1646  */\n+  case 66:\n+#line 1168 \"grammar.y\" /* yacc.c:1646  */\n     {\n         int mem_offset = LOOP_LOCAL_VARS * compiler->loop_depth;\n         uint8_t* addr;\n@@ -2771,11 +2780,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         compiler->loop_identifier[compiler->loop_depth] = NULL;\n         compiler->loop_depth++;\n       }\n-#line 2775 \"grammar.c\" /* yacc.c:1646  */\n+#line 2784 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 66:\n-#line 1193 \"grammar.y\" /* yacc.c:1646  */\n+  case 67:\n+#line 1198 \"grammar.y\" /* yacc.c:1646  */\n     {\n         int mem_offset;\n \n@@ -2824,31 +2833,31 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         (yyval.expression).type = EXPRESSION_TYPE_BOOLEAN;\n \n       }\n-#line 2828 \"grammar.c\" /* yacc.c:1646  */\n+#line 2837 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 67:\n-#line 1242 \"grammar.y\" /* yacc.c:1646  */\n+  case 68:\n+#line 1247 \"grammar.y\" /* yacc.c:1646  */\n     {\n         yr_parser_emit(yyscanner, OP_OF, NULL);\n \n         (yyval.expression).type = EXPRESSION_TYPE_BOOLEAN;\n       }\n-#line 2838 \"grammar.c\" /* yacc.c:1646  */\n+#line 2847 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 68:\n-#line 1248 \"grammar.y\" /* yacc.c:1646  */\n+  case 69:\n+#line 1253 \"grammar.y\" /* yacc.c:1646  */\n     {\n         yr_parser_emit(yyscanner, OP_NOT, NULL);\n \n         (yyval.expression).type = EXPRESSION_TYPE_BOOLEAN;\n       }\n-#line 2848 \"grammar.c\" /* yacc.c:1646  */\n+#line 2857 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 69:\n-#line 1254 \"grammar.y\" /* yacc.c:1646  */\n+  case 70:\n+#line 1259 \"grammar.y\" /* yacc.c:1646  */\n     {\n         YR_FIXUP* fixup;\n         void* jmp_destination_addr;\n@@ -2874,11 +2883,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         fixup->next = compiler->fixup_stack_head;\n         compiler->fixup_stack_head = fixup;\n       }\n-#line 2878 \"grammar.c\" /* yacc.c:1646  */\n+#line 2887 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 70:\n-#line 1280 \"grammar.y\" /* yacc.c:1646  */\n+  case 71:\n+#line 1285 \"grammar.y\" /* yacc.c:1646  */\n     {\n         YR_FIXUP* fixup;\n         uint8_t* and_addr;\n@@ -2914,11 +2923,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n         (yyval.expression).type = EXPRESSION_TYPE_BOOLEAN;\n       }\n-#line 2918 \"grammar.c\" /* yacc.c:1646  */\n+#line 2927 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 71:\n-#line 1316 \"grammar.y\" /* yacc.c:1646  */\n+  case 72:\n+#line 1321 \"grammar.y\" /* yacc.c:1646  */\n     {\n         YR_FIXUP* fixup;\n         void* jmp_destination_addr;\n@@ -2943,11 +2952,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         fixup->next = compiler->fixup_stack_head;\n         compiler->fixup_stack_head = fixup;\n       }\n-#line 2947 \"grammar.c\" /* yacc.c:1646  */\n+#line 2956 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 72:\n-#line 1341 \"grammar.y\" /* yacc.c:1646  */\n+  case 73:\n+#line 1346 \"grammar.y\" /* yacc.c:1646  */\n     {\n         YR_FIXUP* fixup;\n         uint8_t* or_addr;\n@@ -2983,11 +2992,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n         (yyval.expression).type = EXPRESSION_TYPE_BOOLEAN;\n       }\n-#line 2987 \"grammar.c\" /* yacc.c:1646  */\n+#line 2996 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 73:\n-#line 1377 \"grammar.y\" /* yacc.c:1646  */\n+  case 74:\n+#line 1382 \"grammar.y\" /* yacc.c:1646  */\n     {\n         compiler->last_result = yr_parser_reduce_operation(\n             yyscanner, \"<\", (yyvsp[-2].expression), (yyvsp[0].expression));\n@@ -2996,11 +3005,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n         (yyval.expression).type = EXPRESSION_TYPE_BOOLEAN;\n       }\n-#line 3000 \"grammar.c\" /* yacc.c:1646  */\n+#line 3009 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 74:\n-#line 1386 \"grammar.y\" /* yacc.c:1646  */\n+  case 75:\n+#line 1391 \"grammar.y\" /* yacc.c:1646  */\n     {\n         compiler->last_result = yr_parser_reduce_operation(\n             yyscanner, \">\", (yyvsp[-2].expression), (yyvsp[0].expression));\n@@ -3009,11 +3018,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n         (yyval.expression).type = EXPRESSION_TYPE_BOOLEAN;\n       }\n-#line 3013 \"grammar.c\" /* yacc.c:1646  */\n+#line 3022 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 75:\n-#line 1395 \"grammar.y\" /* yacc.c:1646  */\n+  case 76:\n+#line 1400 \"grammar.y\" /* yacc.c:1646  */\n     {\n         compiler->last_result = yr_parser_reduce_operation(\n             yyscanner, \"<=\", (yyvsp[-2].expression), (yyvsp[0].expression));\n@@ -3022,11 +3031,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n         (yyval.expression).type = EXPRESSION_TYPE_BOOLEAN;\n       }\n-#line 3026 \"grammar.c\" /* yacc.c:1646  */\n+#line 3035 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 76:\n-#line 1404 \"grammar.y\" /* yacc.c:1646  */\n+  case 77:\n+#line 1409 \"grammar.y\" /* yacc.c:1646  */\n     {\n         compiler->last_result = yr_parser_reduce_operation(\n             yyscanner, \">=\", (yyvsp[-2].expression), (yyvsp[0].expression));\n@@ -3035,11 +3044,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n         (yyval.expression).type = EXPRESSION_TYPE_BOOLEAN;\n       }\n-#line 3039 \"grammar.c\" /* yacc.c:1646  */\n+#line 3048 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 77:\n-#line 1413 \"grammar.y\" /* yacc.c:1646  */\n+  case 78:\n+#line 1418 \"grammar.y\" /* yacc.c:1646  */\n     {\n         compiler->last_result = yr_parser_reduce_operation(\n             yyscanner, \"==\", (yyvsp[-2].expression), (yyvsp[0].expression));\n@@ -3048,11 +3057,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n         (yyval.expression).type = EXPRESSION_TYPE_BOOLEAN;\n       }\n-#line 3052 \"grammar.c\" /* yacc.c:1646  */\n+#line 3061 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 78:\n-#line 1422 \"grammar.y\" /* yacc.c:1646  */\n+  case 79:\n+#line 1427 \"grammar.y\" /* yacc.c:1646  */\n     {\n         compiler->last_result = yr_parser_reduce_operation(\n             yyscanner, \"!=\", (yyvsp[-2].expression), (yyvsp[0].expression));\n@@ -3061,39 +3070,39 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n         (yyval.expression).type = EXPRESSION_TYPE_BOOLEAN;\n       }\n-#line 3065 \"grammar.c\" /* yacc.c:1646  */\n+#line 3074 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 79:\n-#line 1431 \"grammar.y\" /* yacc.c:1646  */\n+  case 80:\n+#line 1436 \"grammar.y\" /* yacc.c:1646  */\n     {\n         (yyval.expression) = (yyvsp[0].expression);\n       }\n-#line 3073 \"grammar.c\" /* yacc.c:1646  */\n+#line 3082 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 80:\n-#line 1435 \"grammar.y\" /* yacc.c:1646  */\n+  case 81:\n+#line 1440 \"grammar.y\" /* yacc.c:1646  */\n     {\n         (yyval.expression) = (yyvsp[-1].expression);\n       }\n-#line 3081 \"grammar.c\" /* yacc.c:1646  */\n+#line 3090 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 81:\n-#line 1442 \"grammar.y\" /* yacc.c:1646  */\n+  case 82:\n+#line 1447 \"grammar.y\" /* yacc.c:1646  */\n     { (yyval.integer) = INTEGER_SET_ENUMERATION; }\n-#line 3087 \"grammar.c\" /* yacc.c:1646  */\n+#line 3096 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 82:\n-#line 1443 \"grammar.y\" /* yacc.c:1646  */\n+  case 83:\n+#line 1448 \"grammar.y\" /* yacc.c:1646  */\n     { (yyval.integer) = INTEGER_SET_RANGE; }\n-#line 3093 \"grammar.c\" /* yacc.c:1646  */\n+#line 3102 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 83:\n-#line 1449 \"grammar.y\" /* yacc.c:1646  */\n+  case 84:\n+#line 1454 \"grammar.y\" /* yacc.c:1646  */\n     {\n         if ((yyvsp[-3].expression).type != EXPRESSION_TYPE_INTEGER)\n         {\n@@ -3111,11 +3120,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n         ERROR_IF(compiler->last_result != ERROR_SUCCESS);\n       }\n-#line 3115 \"grammar.c\" /* yacc.c:1646  */\n+#line 3124 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 84:\n-#line 1471 \"grammar.y\" /* yacc.c:1646  */\n+  case 85:\n+#line 1476 \"grammar.y\" /* yacc.c:1646  */\n     {\n         if ((yyvsp[0].expression).type != EXPRESSION_TYPE_INTEGER)\n         {\n@@ -3127,11 +3136,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n         ERROR_IF(compiler->last_result != ERROR_SUCCESS);\n       }\n-#line 3131 \"grammar.c\" /* yacc.c:1646  */\n+#line 3140 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 85:\n-#line 1483 \"grammar.y\" /* yacc.c:1646  */\n+  case 86:\n+#line 1488 \"grammar.y\" /* yacc.c:1646  */\n     {\n         if ((yyvsp[0].expression).type != EXPRESSION_TYPE_INTEGER)\n         {\n@@ -3142,77 +3151,77 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n         ERROR_IF(compiler->last_result != ERROR_SUCCESS);\n       }\n-#line 3146 \"grammar.c\" /* yacc.c:1646  */\n+#line 3155 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 86:\n-#line 1498 \"grammar.y\" /* yacc.c:1646  */\n+  case 87:\n+#line 1503 \"grammar.y\" /* yacc.c:1646  */\n     {\n         // Push end-of-list marker\n         yr_parser_emit_with_arg(yyscanner, OP_PUSH, UNDEFINED, NULL, NULL);\n       }\n-#line 3155 \"grammar.c\" /* yacc.c:1646  */\n+#line 3164 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 88:\n-#line 1504 \"grammar.y\" /* yacc.c:1646  */\n+  case 89:\n+#line 1509 \"grammar.y\" /* yacc.c:1646  */\n     {\n         yr_parser_emit_with_arg(yyscanner, OP_PUSH, UNDEFINED, NULL, NULL);\n         yr_parser_emit_pushes_for_strings(yyscanner, \"$*\");\n \n         ERROR_IF(compiler->last_result != ERROR_SUCCESS);\n       }\n-#line 3166 \"grammar.c\" /* yacc.c:1646  */\n+#line 3175 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 91:\n-#line 1521 \"grammar.y\" /* yacc.c:1646  */\n+  case 92:\n+#line 1526 \"grammar.y\" /* yacc.c:1646  */\n     {\n         yr_parser_emit_pushes_for_strings(yyscanner, (yyvsp[0].c_string));\n         yr_free((yyvsp[0].c_string));\n \n         ERROR_IF(compiler->last_result != ERROR_SUCCESS);\n       }\n-#line 3177 \"grammar.c\" /* yacc.c:1646  */\n+#line 3186 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 92:\n-#line 1528 \"grammar.y\" /* yacc.c:1646  */\n+  case 93:\n+#line 1533 \"grammar.y\" /* yacc.c:1646  */\n     {\n         yr_parser_emit_pushes_for_strings(yyscanner, (yyvsp[0].c_string));\n         yr_free((yyvsp[0].c_string));\n \n         ERROR_IF(compiler->last_result != ERROR_SUCCESS);\n       }\n-#line 3188 \"grammar.c\" /* yacc.c:1646  */\n+#line 3197 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 94:\n-#line 1540 \"grammar.y\" /* yacc.c:1646  */\n+  case 95:\n+#line 1545 \"grammar.y\" /* yacc.c:1646  */\n     {\n         yr_parser_emit_with_arg(yyscanner, OP_PUSH, UNDEFINED, NULL, NULL);\n       }\n-#line 3196 \"grammar.c\" /* yacc.c:1646  */\n+#line 3205 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 95:\n-#line 1544 \"grammar.y\" /* yacc.c:1646  */\n+  case 96:\n+#line 1549 \"grammar.y\" /* yacc.c:1646  */\n     {\n         yr_parser_emit_with_arg(yyscanner, OP_PUSH, 1, NULL, NULL);\n       }\n-#line 3204 \"grammar.c\" /* yacc.c:1646  */\n+#line 3213 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 96:\n-#line 1552 \"grammar.y\" /* yacc.c:1646  */\n+  case 97:\n+#line 1557 \"grammar.y\" /* yacc.c:1646  */\n     {\n         (yyval.expression) = (yyvsp[-1].expression);\n       }\n-#line 3212 \"grammar.c\" /* yacc.c:1646  */\n+#line 3221 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 97:\n-#line 1556 \"grammar.y\" /* yacc.c:1646  */\n+  case 98:\n+#line 1561 \"grammar.y\" /* yacc.c:1646  */\n     {\n         compiler->last_result = yr_parser_emit(\n             yyscanner, OP_FILESIZE, NULL);\n@@ -3222,11 +3231,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         (yyval.expression).type = EXPRESSION_TYPE_INTEGER;\n         (yyval.expression).value.integer = UNDEFINED;\n       }\n-#line 3226 \"grammar.c\" /* yacc.c:1646  */\n+#line 3235 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 98:\n-#line 1566 \"grammar.y\" /* yacc.c:1646  */\n+  case 99:\n+#line 1571 \"grammar.y\" /* yacc.c:1646  */\n     {\n         yywarning(yyscanner,\n             \"Using deprecated \\\"entrypoint\\\" keyword. Use the \\\"entry_point\\\" \"\n@@ -3240,11 +3249,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         (yyval.expression).type = EXPRESSION_TYPE_INTEGER;\n         (yyval.expression).value.integer = UNDEFINED;\n       }\n-#line 3244 \"grammar.c\" /* yacc.c:1646  */\n+#line 3253 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 99:\n-#line 1580 \"grammar.y\" /* yacc.c:1646  */\n+  case 100:\n+#line 1585 \"grammar.y\" /* yacc.c:1646  */\n     {\n         CHECK_TYPE((yyvsp[-1].expression), EXPRESSION_TYPE_INTEGER, \"intXXXX or uintXXXX\");\n \n@@ -3260,11 +3269,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         (yyval.expression).type = EXPRESSION_TYPE_INTEGER;\n         (yyval.expression).value.integer = UNDEFINED;\n       }\n-#line 3264 \"grammar.c\" /* yacc.c:1646  */\n+#line 3273 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 100:\n-#line 1596 \"grammar.y\" /* yacc.c:1646  */\n+  case 101:\n+#line 1601 \"grammar.y\" /* yacc.c:1646  */\n     {\n         compiler->last_result = yr_parser_emit_with_arg(\n             yyscanner, OP_PUSH, (yyvsp[0].integer), NULL, NULL);\n@@ -3274,11 +3283,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         (yyval.expression).type = EXPRESSION_TYPE_INTEGER;\n         (yyval.expression).value.integer = (yyvsp[0].integer);\n       }\n-#line 3278 \"grammar.c\" /* yacc.c:1646  */\n+#line 3287 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 101:\n-#line 1606 \"grammar.y\" /* yacc.c:1646  */\n+  case 102:\n+#line 1611 \"grammar.y\" /* yacc.c:1646  */\n     {\n         compiler->last_result = yr_parser_emit_with_arg_double(\n             yyscanner, OP_PUSH, (yyvsp[0].double_), NULL, NULL);\n@@ -3287,11 +3296,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n         (yyval.expression).type = EXPRESSION_TYPE_FLOAT;\n       }\n-#line 3291 \"grammar.c\" /* yacc.c:1646  */\n+#line 3300 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 102:\n-#line 1615 \"grammar.y\" /* yacc.c:1646  */\n+  case 103:\n+#line 1620 \"grammar.y\" /* yacc.c:1646  */\n     {\n         SIZED_STRING* sized_string;\n \n@@ -3316,11 +3325,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         (yyval.expression).type = EXPRESSION_TYPE_STRING;\n         (yyval.expression).value.sized_string = sized_string;\n       }\n-#line 3320 \"grammar.c\" /* yacc.c:1646  */\n+#line 3329 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 103:\n-#line 1640 \"grammar.y\" /* yacc.c:1646  */\n+  case 104:\n+#line 1645 \"grammar.y\" /* yacc.c:1646  */\n     {\n         compiler->last_result = yr_parser_reduce_string_identifier(\n             yyscanner, (yyvsp[0].c_string), OP_COUNT, UNDEFINED);\n@@ -3332,11 +3341,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         (yyval.expression).type = EXPRESSION_TYPE_INTEGER;\n         (yyval.expression).value.integer = UNDEFINED;\n       }\n-#line 3336 \"grammar.c\" /* yacc.c:1646  */\n+#line 3345 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 104:\n-#line 1652 \"grammar.y\" /* yacc.c:1646  */\n+  case 105:\n+#line 1657 \"grammar.y\" /* yacc.c:1646  */\n     {\n         compiler->last_result = yr_parser_reduce_string_identifier(\n             yyscanner, (yyvsp[-3].c_string), OP_OFFSET, UNDEFINED);\n@@ -3348,11 +3357,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         (yyval.expression).type = EXPRESSION_TYPE_INTEGER;\n         (yyval.expression).value.integer = UNDEFINED;\n       }\n-#line 3352 \"grammar.c\" /* yacc.c:1646  */\n+#line 3361 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 105:\n-#line 1664 \"grammar.y\" /* yacc.c:1646  */\n+  case 106:\n+#line 1669 \"grammar.y\" /* yacc.c:1646  */\n     {\n         compiler->last_result = yr_parser_emit_with_arg(\n             yyscanner, OP_PUSH, 1, NULL, NULL);\n@@ -3368,11 +3377,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         (yyval.expression).type = EXPRESSION_TYPE_INTEGER;\n         (yyval.expression).value.integer = UNDEFINED;\n       }\n-#line 3372 \"grammar.c\" /* yacc.c:1646  */\n+#line 3381 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 106:\n-#line 1680 \"grammar.y\" /* yacc.c:1646  */\n+  case 107:\n+#line 1685 \"grammar.y\" /* yacc.c:1646  */\n     {\n         compiler->last_result = yr_parser_reduce_string_identifier(\n             yyscanner, (yyvsp[-3].c_string), OP_LENGTH, UNDEFINED);\n@@ -3384,11 +3393,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         (yyval.expression).type = EXPRESSION_TYPE_INTEGER;\n         (yyval.expression).value.integer = UNDEFINED;\n       }\n-#line 3388 \"grammar.c\" /* yacc.c:1646  */\n+#line 3397 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 107:\n-#line 1692 \"grammar.y\" /* yacc.c:1646  */\n+  case 108:\n+#line 1697 \"grammar.y\" /* yacc.c:1646  */\n     {\n         compiler->last_result = yr_parser_emit_with_arg(\n             yyscanner, OP_PUSH, 1, NULL, NULL);\n@@ -3404,11 +3413,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         (yyval.expression).type = EXPRESSION_TYPE_INTEGER;\n         (yyval.expression).value.integer = UNDEFINED;\n       }\n-#line 3408 \"grammar.c\" /* yacc.c:1646  */\n+#line 3417 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 108:\n-#line 1708 \"grammar.y\" /* yacc.c:1646  */\n+  case 109:\n+#line 1713 \"grammar.y\" /* yacc.c:1646  */\n     {\n         if ((yyvsp[0].expression).type == EXPRESSION_TYPE_INTEGER)  // loop identifier\n         {\n@@ -3453,11 +3462,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n         ERROR_IF(compiler->last_result != ERROR_SUCCESS);\n       }\n-#line 3457 \"grammar.c\" /* yacc.c:1646  */\n+#line 3466 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 109:\n-#line 1753 \"grammar.y\" /* yacc.c:1646  */\n+  case 110:\n+#line 1758 \"grammar.y\" /* yacc.c:1646  */\n     {\n         CHECK_TYPE((yyvsp[0].expression), EXPRESSION_TYPE_INTEGER | EXPRESSION_TYPE_FLOAT, \"-\");\n \n@@ -3476,11 +3485,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n         ERROR_IF(compiler->last_result != ERROR_SUCCESS);\n       }\n-#line 3480 \"grammar.c\" /* yacc.c:1646  */\n+#line 3489 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 110:\n-#line 1772 \"grammar.y\" /* yacc.c:1646  */\n+  case 111:\n+#line 1777 \"grammar.y\" /* yacc.c:1646  */\n     {\n         compiler->last_result = yr_parser_reduce_operation(\n             yyscanner, \"+\", (yyvsp[-2].expression), (yyvsp[0].expression));\n@@ -3498,11 +3507,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n           (yyval.expression).type = EXPRESSION_TYPE_FLOAT;\n         }\n       }\n-#line 3502 \"grammar.c\" /* yacc.c:1646  */\n+#line 3511 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 111:\n-#line 1790 \"grammar.y\" /* yacc.c:1646  */\n+  case 112:\n+#line 1795 \"grammar.y\" /* yacc.c:1646  */\n     {\n         compiler->last_result = yr_parser_reduce_operation(\n             yyscanner, \"-\", (yyvsp[-2].expression), (yyvsp[0].expression));\n@@ -3520,11 +3529,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n           (yyval.expression).type = EXPRESSION_TYPE_FLOAT;\n         }\n       }\n-#line 3524 \"grammar.c\" /* yacc.c:1646  */\n+#line 3533 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 112:\n-#line 1808 \"grammar.y\" /* yacc.c:1646  */\n+  case 113:\n+#line 1813 \"grammar.y\" /* yacc.c:1646  */\n     {\n         compiler->last_result = yr_parser_reduce_operation(\n             yyscanner, \"*\", (yyvsp[-2].expression), (yyvsp[0].expression));\n@@ -3542,11 +3551,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n           (yyval.expression).type = EXPRESSION_TYPE_FLOAT;\n         }\n       }\n-#line 3546 \"grammar.c\" /* yacc.c:1646  */\n+#line 3555 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 113:\n-#line 1826 \"grammar.y\" /* yacc.c:1646  */\n+  case 114:\n+#line 1831 \"grammar.y\" /* yacc.c:1646  */\n     {\n         compiler->last_result = yr_parser_reduce_operation(\n             yyscanner, \"\\\\\", (yyvsp[-2].expression), (yyvsp[0].expression));\n@@ -3572,11 +3581,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n           (yyval.expression).type = EXPRESSION_TYPE_FLOAT;\n         }\n       }\n-#line 3576 \"grammar.c\" /* yacc.c:1646  */\n+#line 3585 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 114:\n-#line 1852 \"grammar.y\" /* yacc.c:1646  */\n+  case 115:\n+#line 1857 \"grammar.y\" /* yacc.c:1646  */\n     {\n         CHECK_TYPE((yyvsp[-2].expression), EXPRESSION_TYPE_INTEGER, \"%\");\n         CHECK_TYPE((yyvsp[0].expression), EXPRESSION_TYPE_INTEGER, \"%\");\n@@ -3594,11 +3603,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n           ERROR_IF(compiler->last_result != ERROR_SUCCESS);\n         }\n       }\n-#line 3598 \"grammar.c\" /* yacc.c:1646  */\n+#line 3607 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 115:\n-#line 1870 \"grammar.y\" /* yacc.c:1646  */\n+  case 116:\n+#line 1875 \"grammar.y\" /* yacc.c:1646  */\n     {\n         CHECK_TYPE((yyvsp[-2].expression), EXPRESSION_TYPE_INTEGER, \"^\");\n         CHECK_TYPE((yyvsp[0].expression), EXPRESSION_TYPE_INTEGER, \"^\");\n@@ -3608,11 +3617,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         (yyval.expression).type = EXPRESSION_TYPE_INTEGER;\n         (yyval.expression).value.integer = OPERATION(^, (yyvsp[-2].expression).value.integer, (yyvsp[0].expression).value.integer);\n       }\n-#line 3612 \"grammar.c\" /* yacc.c:1646  */\n+#line 3621 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 116:\n-#line 1880 \"grammar.y\" /* yacc.c:1646  */\n+  case 117:\n+#line 1885 \"grammar.y\" /* yacc.c:1646  */\n     {\n         CHECK_TYPE((yyvsp[-2].expression), EXPRESSION_TYPE_INTEGER, \"^\");\n         CHECK_TYPE((yyvsp[0].expression), EXPRESSION_TYPE_INTEGER, \"^\");\n@@ -3622,11 +3631,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         (yyval.expression).type = EXPRESSION_TYPE_INTEGER;\n         (yyval.expression).value.integer = OPERATION(&, (yyvsp[-2].expression).value.integer, (yyvsp[0].expression).value.integer);\n       }\n-#line 3626 \"grammar.c\" /* yacc.c:1646  */\n+#line 3635 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 117:\n-#line 1890 \"grammar.y\" /* yacc.c:1646  */\n+  case 118:\n+#line 1895 \"grammar.y\" /* yacc.c:1646  */\n     {\n         CHECK_TYPE((yyvsp[-2].expression), EXPRESSION_TYPE_INTEGER, \"|\");\n         CHECK_TYPE((yyvsp[0].expression), EXPRESSION_TYPE_INTEGER, \"|\");\n@@ -3636,11 +3645,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         (yyval.expression).type = EXPRESSION_TYPE_INTEGER;\n         (yyval.expression).value.integer = OPERATION(|, (yyvsp[-2].expression).value.integer, (yyvsp[0].expression).value.integer);\n       }\n-#line 3640 \"grammar.c\" /* yacc.c:1646  */\n+#line 3649 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 118:\n-#line 1900 \"grammar.y\" /* yacc.c:1646  */\n+  case 119:\n+#line 1905 \"grammar.y\" /* yacc.c:1646  */\n     {\n         CHECK_TYPE((yyvsp[0].expression), EXPRESSION_TYPE_INTEGER, \"~\");\n \n@@ -3650,11 +3659,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         (yyval.expression).value.integer = ((yyvsp[0].expression).value.integer == UNDEFINED) ?\n             UNDEFINED : ~((yyvsp[0].expression).value.integer);\n       }\n-#line 3654 \"grammar.c\" /* yacc.c:1646  */\n+#line 3663 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 119:\n-#line 1910 \"grammar.y\" /* yacc.c:1646  */\n+  case 120:\n+#line 1915 \"grammar.y\" /* yacc.c:1646  */\n     {\n         CHECK_TYPE((yyvsp[-2].expression), EXPRESSION_TYPE_INTEGER, \"<<\");\n         CHECK_TYPE((yyvsp[0].expression), EXPRESSION_TYPE_INTEGER, \"<<\");\n@@ -3664,11 +3673,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         (yyval.expression).type = EXPRESSION_TYPE_INTEGER;\n         (yyval.expression).value.integer = OPERATION(<<, (yyvsp[-2].expression).value.integer, (yyvsp[0].expression).value.integer);\n       }\n-#line 3668 \"grammar.c\" /* yacc.c:1646  */\n+#line 3677 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 120:\n-#line 1920 \"grammar.y\" /* yacc.c:1646  */\n+  case 121:\n+#line 1925 \"grammar.y\" /* yacc.c:1646  */\n     {\n         CHECK_TYPE((yyvsp[-2].expression), EXPRESSION_TYPE_INTEGER, \">>\");\n         CHECK_TYPE((yyvsp[0].expression), EXPRESSION_TYPE_INTEGER, \">>\");\n@@ -3678,19 +3687,19 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         (yyval.expression).type = EXPRESSION_TYPE_INTEGER;\n         (yyval.expression).value.integer = OPERATION(>>, (yyvsp[-2].expression).value.integer, (yyvsp[0].expression).value.integer);\n       }\n-#line 3682 \"grammar.c\" /* yacc.c:1646  */\n+#line 3691 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n-  case 121:\n-#line 1930 \"grammar.y\" /* yacc.c:1646  */\n+  case 122:\n+#line 1935 \"grammar.y\" /* yacc.c:1646  */\n     {\n         (yyval.expression) = (yyvsp[0].expression);\n       }\n-#line 3690 \"grammar.c\" /* yacc.c:1646  */\n+#line 3699 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n \n-#line 3694 \"grammar.c\" /* yacc.c:1646  */\n+#line 3703 \"grammar.c\" /* yacc.c:1646  */\n       default: break;\n     }\n   /* User semantic actions sometimes alter yychar, and that requires\n@@ -3918,5 +3927,5 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n #endif\n   return yyresult;\n }\n-#line 1935 \"grammar.y\" /* yacc.c:1906  */\n+#line 1940 \"grammar.y\" /* yacc.c:1906  */\n "
    },
    "modified_file_1": {
        "mod_filename": "libyara/grammar.y",
        "status": "modified",
        "add_lines": 5,
        "dele_lines": 0,
        "patch": "@@ -1015,6 +1015,11 @@ expression\n \n         $$.type = EXPRESSION_TYPE_BOOLEAN;\n       }\n+    | _FOR_ for_expression error\n+      {\n+        compiler->loop_depth--;\n+        compiler->loop_identifier[compiler->loop_depth] = NULL;\n+      }\n     | _FOR_ for_expression _IDENTIFIER_ _IN_\n       {\n         int var_index;"
    }
}