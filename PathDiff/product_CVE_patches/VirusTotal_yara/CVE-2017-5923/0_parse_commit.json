{
    "current_hash": "ab906da53ff2a68c6fd6d1fa73f2b7c7bf0bc636",
    "parent_hash": "5a8f180d372eace8293c8a3bb60e133bbf502458",
    "modified_file_0": {
        "mod_filename": "libyara/grammar.c",
        "status": "modified",
        "add_lines": 151,
        "dele_lines": 145,
        "patch": "@@ -611,14 +611,14 @@ static const yytype_uint16 yyrline[] =\n      347,   353,   356,   374,   387,   424,   425,   430,   446,   459,\n      472,   485,   502,   503,   509,   508,   524,   523,   539,   553,\n      554,   559,   560,   561,   562,   567,   652,   698,   756,   801,\n-     802,   806,   831,   867,   913,   935,   944,   953,   968,   980,\n-     994,  1007,  1018,  1027,  1057,  1026,  1171,  1170,  1249,  1255,\n-    1262,  1261,  1324,  1323,  1384,  1393,  1402,  1411,  1420,  1429,\n-    1438,  1442,  1450,  1451,  1456,  1478,  1490,  1506,  1505,  1511,\n-    1522,  1523,  1528,  1535,  1546,  1547,  1551,  1559,  1563,  1573,\n-    1587,  1603,  1613,  1622,  1647,  1659,  1671,  1687,  1699,  1715,\n-    1760,  1779,  1797,  1815,  1833,  1859,  1877,  1887,  1897,  1907,\n-    1917,  1927,  1937\n+     802,   806,   833,   871,   917,   939,   948,   957,   972,   984,\n+     998,  1011,  1022,  1033,  1063,  1032,  1177,  1176,  1255,  1261,\n+    1268,  1267,  1330,  1329,  1390,  1399,  1408,  1417,  1426,  1435,\n+    1444,  1448,  1456,  1457,  1462,  1484,  1496,  1512,  1511,  1517,\n+    1528,  1529,  1534,  1541,  1552,  1553,  1557,  1565,  1569,  1579,\n+    1593,  1609,  1619,  1628,  1653,  1665,  1677,  1693,  1705,  1721,\n+    1766,  1785,  1803,  1821,  1839,  1865,  1883,  1893,  1903,  1913,\n+    1923,  1933,  1943\n };\n #endif\n \n@@ -2361,15 +2361,17 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n           case EXPRESSION_TYPE_REGEXP:\n             strlcpy((yyval.c_string), \"r\", MAX_FUNCTION_ARGS);\n             break;\n+          default:\n+            assert(FALSE);\n         }\n \n         ERROR_IF((yyval.c_string) == NULL);\n       }\n-#line 2369 \"grammar.c\" /* yacc.c:1646  */\n+#line 2371 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 52:\n-#line 832 \"grammar.y\" /* yacc.c:1646  */\n+#line 834 \"grammar.y\" /* yacc.c:1646  */\n     {\n         if (strlen((yyvsp[-2].c_string)) == MAX_FUNCTION_ARGS)\n         {\n@@ -2394,18 +2396,20 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n             case EXPRESSION_TYPE_REGEXP:\n               strlcat((yyvsp[-2].c_string), \"r\", MAX_FUNCTION_ARGS);\n               break;\n+            default:\n+              assert(FALSE);\n           }\n         }\n \n         ERROR_IF(compiler->last_result != ERROR_SUCCESS);\n \n         (yyval.c_string) = (yyvsp[-2].c_string);\n       }\n-#line 2405 \"grammar.c\" /* yacc.c:1646  */\n+#line 2409 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 53:\n-#line 868 \"grammar.y\" /* yacc.c:1646  */\n+#line 872 \"grammar.y\" /* yacc.c:1646  */\n     {\n         SIZED_STRING* sized_string = (yyvsp[0].sized_string);\n         RE* re;\n@@ -2447,11 +2451,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n         (yyval.expression).type = EXPRESSION_TYPE_REGEXP;\n       }\n-#line 2451 \"grammar.c\" /* yacc.c:1646  */\n+#line 2455 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 54:\n-#line 914 \"grammar.y\" /* yacc.c:1646  */\n+#line 918 \"grammar.y\" /* yacc.c:1646  */\n     {\n         if ((yyvsp[0].expression).type == EXPRESSION_TYPE_STRING)\n         {\n@@ -2470,11 +2474,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n         (yyval.expression).type = EXPRESSION_TYPE_BOOLEAN;\n       }\n-#line 2474 \"grammar.c\" /* yacc.c:1646  */\n+#line 2478 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 55:\n-#line 936 \"grammar.y\" /* yacc.c:1646  */\n+#line 940 \"grammar.y\" /* yacc.c:1646  */\n     {\n         compiler->last_result = yr_parser_emit_with_arg(\n             yyscanner, OP_PUSH, 1, NULL, NULL);\n@@ -2483,11 +2487,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n         (yyval.expression).type = EXPRESSION_TYPE_BOOLEAN;\n       }\n-#line 2487 \"grammar.c\" /* yacc.c:1646  */\n+#line 2491 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 56:\n-#line 945 \"grammar.y\" /* yacc.c:1646  */\n+#line 949 \"grammar.y\" /* yacc.c:1646  */\n     {\n         compiler->last_result = yr_parser_emit_with_arg(\n             yyscanner, OP_PUSH, 0, NULL, NULL);\n@@ -2496,11 +2500,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n         (yyval.expression).type = EXPRESSION_TYPE_BOOLEAN;\n       }\n-#line 2500 \"grammar.c\" /* yacc.c:1646  */\n+#line 2504 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 57:\n-#line 954 \"grammar.y\" /* yacc.c:1646  */\n+#line 958 \"grammar.y\" /* yacc.c:1646  */\n     {\n         CHECK_TYPE((yyvsp[-2].expression), EXPRESSION_TYPE_STRING, \"matches\");\n         CHECK_TYPE((yyvsp[0].expression), EXPRESSION_TYPE_REGEXP, \"matches\");\n@@ -2515,11 +2519,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n         (yyval.expression).type = EXPRESSION_TYPE_BOOLEAN;\n       }\n-#line 2519 \"grammar.c\" /* yacc.c:1646  */\n+#line 2523 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 58:\n-#line 969 \"grammar.y\" /* yacc.c:1646  */\n+#line 973 \"grammar.y\" /* yacc.c:1646  */\n     {\n         CHECK_TYPE((yyvsp[-2].expression), EXPRESSION_TYPE_STRING, \"contains\");\n         CHECK_TYPE((yyvsp[0].expression), EXPRESSION_TYPE_STRING, \"contains\");\n@@ -2531,11 +2535,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n         (yyval.expression).type = EXPRESSION_TYPE_BOOLEAN;\n       }\n-#line 2535 \"grammar.c\" /* yacc.c:1646  */\n+#line 2539 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 59:\n-#line 981 \"grammar.y\" /* yacc.c:1646  */\n+#line 985 \"grammar.y\" /* yacc.c:1646  */\n     {\n         int result = yr_parser_reduce_string_identifier(\n             yyscanner,\n@@ -2549,11 +2553,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n         (yyval.expression).type = EXPRESSION_TYPE_BOOLEAN;\n       }\n-#line 2553 \"grammar.c\" /* yacc.c:1646  */\n+#line 2557 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 60:\n-#line 995 \"grammar.y\" /* yacc.c:1646  */\n+#line 999 \"grammar.y\" /* yacc.c:1646  */\n     {\n         CHECK_TYPE((yyvsp[0].expression), EXPRESSION_TYPE_INTEGER, \"at\");\n \n@@ -2566,11 +2570,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n         (yyval.expression).type = EXPRESSION_TYPE_BOOLEAN;\n       }\n-#line 2570 \"grammar.c\" /* yacc.c:1646  */\n+#line 2574 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 61:\n-#line 1008 \"grammar.y\" /* yacc.c:1646  */\n+#line 1012 \"grammar.y\" /* yacc.c:1646  */\n     {\n         compiler->last_result = yr_parser_reduce_string_identifier(\n             yyscanner, (yyvsp[-2].c_string), OP_FOUND_IN, UNDEFINED);\n@@ -2581,23 +2585,25 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n         (yyval.expression).type = EXPRESSION_TYPE_BOOLEAN;\n       }\n-#line 2585 \"grammar.c\" /* yacc.c:1646  */\n+#line 2589 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 62:\n-#line 1019 \"grammar.y\" /* yacc.c:1646  */\n+#line 1023 \"grammar.y\" /* yacc.c:1646  */\n     {\n         if (compiler->loop_depth > 0)\n         {\n           compiler->loop_depth--;\n           compiler->loop_identifier[compiler->loop_depth] = NULL;\n         }\n+\n+        YYERROR;\n       }\n-#line 2597 \"grammar.c\" /* yacc.c:1646  */\n+#line 2603 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 63:\n-#line 1027 \"grammar.y\" /* yacc.c:1646  */\n+#line 1033 \"grammar.y\" /* yacc.c:1646  */\n     {\n         int var_index;\n \n@@ -2627,11 +2633,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n         ERROR_IF(compiler->last_result != ERROR_SUCCESS);\n       }\n-#line 2631 \"grammar.c\" /* yacc.c:1646  */\n+#line 2637 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 64:\n-#line 1057 \"grammar.y\" /* yacc.c:1646  */\n+#line 1063 \"grammar.y\" /* yacc.c:1646  */\n     {\n         int mem_offset = LOOP_LOCAL_VARS * compiler->loop_depth;\n         uint8_t* addr;\n@@ -2666,11 +2672,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         compiler->loop_identifier[compiler->loop_depth] = (yyvsp[-4].c_string);\n         compiler->loop_depth++;\n       }\n-#line 2670 \"grammar.c\" /* yacc.c:1646  */\n+#line 2676 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 65:\n-#line 1092 \"grammar.y\" /* yacc.c:1646  */\n+#line 1098 \"grammar.y\" /* yacc.c:1646  */\n     {\n         int mem_offset;\n \n@@ -2749,11 +2755,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n         (yyval.expression).type = EXPRESSION_TYPE_BOOLEAN;\n       }\n-#line 2753 \"grammar.c\" /* yacc.c:1646  */\n+#line 2759 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 66:\n-#line 1171 \"grammar.y\" /* yacc.c:1646  */\n+#line 1177 \"grammar.y\" /* yacc.c:1646  */\n     {\n         int mem_offset = LOOP_LOCAL_VARS * compiler->loop_depth;\n         uint8_t* addr;\n@@ -2783,11 +2789,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         compiler->loop_identifier[compiler->loop_depth] = NULL;\n         compiler->loop_depth++;\n       }\n-#line 2787 \"grammar.c\" /* yacc.c:1646  */\n+#line 2793 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 67:\n-#line 1201 \"grammar.y\" /* yacc.c:1646  */\n+#line 1207 \"grammar.y\" /* yacc.c:1646  */\n     {\n         int mem_offset;\n \n@@ -2836,31 +2842,31 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         (yyval.expression).type = EXPRESSION_TYPE_BOOLEAN;\n \n       }\n-#line 2840 \"grammar.c\" /* yacc.c:1646  */\n+#line 2846 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 68:\n-#line 1250 \"grammar.y\" /* yacc.c:1646  */\n+#line 1256 \"grammar.y\" /* yacc.c:1646  */\n     {\n         yr_parser_emit(yyscanner, OP_OF, NULL);\n \n         (yyval.expression).type = EXPRESSION_TYPE_BOOLEAN;\n       }\n-#line 2850 \"grammar.c\" /* yacc.c:1646  */\n+#line 2856 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 69:\n-#line 1256 \"grammar.y\" /* yacc.c:1646  */\n+#line 1262 \"grammar.y\" /* yacc.c:1646  */\n     {\n         yr_parser_emit(yyscanner, OP_NOT, NULL);\n \n         (yyval.expression).type = EXPRESSION_TYPE_BOOLEAN;\n       }\n-#line 2860 \"grammar.c\" /* yacc.c:1646  */\n+#line 2866 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 70:\n-#line 1262 \"grammar.y\" /* yacc.c:1646  */\n+#line 1268 \"grammar.y\" /* yacc.c:1646  */\n     {\n         YR_FIXUP* fixup;\n         void* jmp_destination_addr;\n@@ -2886,11 +2892,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         fixup->next = compiler->fixup_stack_head;\n         compiler->fixup_stack_head = fixup;\n       }\n-#line 2890 \"grammar.c\" /* yacc.c:1646  */\n+#line 2896 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 71:\n-#line 1288 \"grammar.y\" /* yacc.c:1646  */\n+#line 1294 \"grammar.y\" /* yacc.c:1646  */\n     {\n         YR_FIXUP* fixup;\n         uint8_t* and_addr;\n@@ -2926,11 +2932,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n         (yyval.expression).type = EXPRESSION_TYPE_BOOLEAN;\n       }\n-#line 2930 \"grammar.c\" /* yacc.c:1646  */\n+#line 2936 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 72:\n-#line 1324 \"grammar.y\" /* yacc.c:1646  */\n+#line 1330 \"grammar.y\" /* yacc.c:1646  */\n     {\n         YR_FIXUP* fixup;\n         void* jmp_destination_addr;\n@@ -2955,11 +2961,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         fixup->next = compiler->fixup_stack_head;\n         compiler->fixup_stack_head = fixup;\n       }\n-#line 2959 \"grammar.c\" /* yacc.c:1646  */\n+#line 2965 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 73:\n-#line 1349 \"grammar.y\" /* yacc.c:1646  */\n+#line 1355 \"grammar.y\" /* yacc.c:1646  */\n     {\n         YR_FIXUP* fixup;\n         uint8_t* or_addr;\n@@ -2995,11 +3001,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n         (yyval.expression).type = EXPRESSION_TYPE_BOOLEAN;\n       }\n-#line 2999 \"grammar.c\" /* yacc.c:1646  */\n+#line 3005 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 74:\n-#line 1385 \"grammar.y\" /* yacc.c:1646  */\n+#line 1391 \"grammar.y\" /* yacc.c:1646  */\n     {\n         compiler->last_result = yr_parser_reduce_operation(\n             yyscanner, \"<\", (yyvsp[-2].expression), (yyvsp[0].expression));\n@@ -3008,11 +3014,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n         (yyval.expression).type = EXPRESSION_TYPE_BOOLEAN;\n       }\n-#line 3012 \"grammar.c\" /* yacc.c:1646  */\n+#line 3018 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 75:\n-#line 1394 \"grammar.y\" /* yacc.c:1646  */\n+#line 1400 \"grammar.y\" /* yacc.c:1646  */\n     {\n         compiler->last_result = yr_parser_reduce_operation(\n             yyscanner, \">\", (yyvsp[-2].expression), (yyvsp[0].expression));\n@@ -3021,11 +3027,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n         (yyval.expression).type = EXPRESSION_TYPE_BOOLEAN;\n       }\n-#line 3025 \"grammar.c\" /* yacc.c:1646  */\n+#line 3031 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 76:\n-#line 1403 \"grammar.y\" /* yacc.c:1646  */\n+#line 1409 \"grammar.y\" /* yacc.c:1646  */\n     {\n         compiler->last_result = yr_parser_reduce_operation(\n             yyscanner, \"<=\", (yyvsp[-2].expression), (yyvsp[0].expression));\n@@ -3034,11 +3040,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n         (yyval.expression).type = EXPRESSION_TYPE_BOOLEAN;\n       }\n-#line 3038 \"grammar.c\" /* yacc.c:1646  */\n+#line 3044 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 77:\n-#line 1412 \"grammar.y\" /* yacc.c:1646  */\n+#line 1418 \"grammar.y\" /* yacc.c:1646  */\n     {\n         compiler->last_result = yr_parser_reduce_operation(\n             yyscanner, \">=\", (yyvsp[-2].expression), (yyvsp[0].expression));\n@@ -3047,11 +3053,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n         (yyval.expression).type = EXPRESSION_TYPE_BOOLEAN;\n       }\n-#line 3051 \"grammar.c\" /* yacc.c:1646  */\n+#line 3057 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 78:\n-#line 1421 \"grammar.y\" /* yacc.c:1646  */\n+#line 1427 \"grammar.y\" /* yacc.c:1646  */\n     {\n         compiler->last_result = yr_parser_reduce_operation(\n             yyscanner, \"==\", (yyvsp[-2].expression), (yyvsp[0].expression));\n@@ -3060,11 +3066,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n         (yyval.expression).type = EXPRESSION_TYPE_BOOLEAN;\n       }\n-#line 3064 \"grammar.c\" /* yacc.c:1646  */\n+#line 3070 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 79:\n-#line 1430 \"grammar.y\" /* yacc.c:1646  */\n+#line 1436 \"grammar.y\" /* yacc.c:1646  */\n     {\n         compiler->last_result = yr_parser_reduce_operation(\n             yyscanner, \"!=\", (yyvsp[-2].expression), (yyvsp[0].expression));\n@@ -3073,39 +3079,39 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n         (yyval.expression).type = EXPRESSION_TYPE_BOOLEAN;\n       }\n-#line 3077 \"grammar.c\" /* yacc.c:1646  */\n+#line 3083 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 80:\n-#line 1439 \"grammar.y\" /* yacc.c:1646  */\n+#line 1445 \"grammar.y\" /* yacc.c:1646  */\n     {\n         (yyval.expression) = (yyvsp[0].expression);\n       }\n-#line 3085 \"grammar.c\" /* yacc.c:1646  */\n+#line 3091 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 81:\n-#line 1443 \"grammar.y\" /* yacc.c:1646  */\n+#line 1449 \"grammar.y\" /* yacc.c:1646  */\n     {\n         (yyval.expression) = (yyvsp[-1].expression);\n       }\n-#line 3093 \"grammar.c\" /* yacc.c:1646  */\n+#line 3099 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 82:\n-#line 1450 \"grammar.y\" /* yacc.c:1646  */\n+#line 1456 \"grammar.y\" /* yacc.c:1646  */\n     { (yyval.integer) = INTEGER_SET_ENUMERATION; }\n-#line 3099 \"grammar.c\" /* yacc.c:1646  */\n+#line 3105 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 83:\n-#line 1451 \"grammar.y\" /* yacc.c:1646  */\n+#line 1457 \"grammar.y\" /* yacc.c:1646  */\n     { (yyval.integer) = INTEGER_SET_RANGE; }\n-#line 3105 \"grammar.c\" /* yacc.c:1646  */\n+#line 3111 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 84:\n-#line 1457 \"grammar.y\" /* yacc.c:1646  */\n+#line 1463 \"grammar.y\" /* yacc.c:1646  */\n     {\n         if ((yyvsp[-3].expression).type != EXPRESSION_TYPE_INTEGER)\n         {\n@@ -3123,11 +3129,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n         ERROR_IF(compiler->last_result != ERROR_SUCCESS);\n       }\n-#line 3127 \"grammar.c\" /* yacc.c:1646  */\n+#line 3133 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 85:\n-#line 1479 \"grammar.y\" /* yacc.c:1646  */\n+#line 1485 \"grammar.y\" /* yacc.c:1646  */\n     {\n         if ((yyvsp[0].expression).type != EXPRESSION_TYPE_INTEGER)\n         {\n@@ -3139,11 +3145,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n         ERROR_IF(compiler->last_result != ERROR_SUCCESS);\n       }\n-#line 3143 \"grammar.c\" /* yacc.c:1646  */\n+#line 3149 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 86:\n-#line 1491 \"grammar.y\" /* yacc.c:1646  */\n+#line 1497 \"grammar.y\" /* yacc.c:1646  */\n     {\n         if ((yyvsp[0].expression).type != EXPRESSION_TYPE_INTEGER)\n         {\n@@ -3154,77 +3160,77 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n         ERROR_IF(compiler->last_result != ERROR_SUCCESS);\n       }\n-#line 3158 \"grammar.c\" /* yacc.c:1646  */\n+#line 3164 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 87:\n-#line 1506 \"grammar.y\" /* yacc.c:1646  */\n+#line 1512 \"grammar.y\" /* yacc.c:1646  */\n     {\n         // Push end-of-list marker\n         yr_parser_emit_with_arg(yyscanner, OP_PUSH, UNDEFINED, NULL, NULL);\n       }\n-#line 3167 \"grammar.c\" /* yacc.c:1646  */\n+#line 3173 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 89:\n-#line 1512 \"grammar.y\" /* yacc.c:1646  */\n+#line 1518 \"grammar.y\" /* yacc.c:1646  */\n     {\n         yr_parser_emit_with_arg(yyscanner, OP_PUSH, UNDEFINED, NULL, NULL);\n         yr_parser_emit_pushes_for_strings(yyscanner, \"$*\");\n \n         ERROR_IF(compiler->last_result != ERROR_SUCCESS);\n       }\n-#line 3178 \"grammar.c\" /* yacc.c:1646  */\n+#line 3184 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 92:\n-#line 1529 \"grammar.y\" /* yacc.c:1646  */\n+#line 1535 \"grammar.y\" /* yacc.c:1646  */\n     {\n         yr_parser_emit_pushes_for_strings(yyscanner, (yyvsp[0].c_string));\n         yr_free((yyvsp[0].c_string));\n \n         ERROR_IF(compiler->last_result != ERROR_SUCCESS);\n       }\n-#line 3189 \"grammar.c\" /* yacc.c:1646  */\n+#line 3195 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 93:\n-#line 1536 \"grammar.y\" /* yacc.c:1646  */\n+#line 1542 \"grammar.y\" /* yacc.c:1646  */\n     {\n         yr_parser_emit_pushes_for_strings(yyscanner, (yyvsp[0].c_string));\n         yr_free((yyvsp[0].c_string));\n \n         ERROR_IF(compiler->last_result != ERROR_SUCCESS);\n       }\n-#line 3200 \"grammar.c\" /* yacc.c:1646  */\n+#line 3206 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 95:\n-#line 1548 \"grammar.y\" /* yacc.c:1646  */\n+#line 1554 \"grammar.y\" /* yacc.c:1646  */\n     {\n         yr_parser_emit_with_arg(yyscanner, OP_PUSH, UNDEFINED, NULL, NULL);\n       }\n-#line 3208 \"grammar.c\" /* yacc.c:1646  */\n+#line 3214 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 96:\n-#line 1552 \"grammar.y\" /* yacc.c:1646  */\n+#line 1558 \"grammar.y\" /* yacc.c:1646  */\n     {\n         yr_parser_emit_with_arg(yyscanner, OP_PUSH, 1, NULL, NULL);\n       }\n-#line 3216 \"grammar.c\" /* yacc.c:1646  */\n+#line 3222 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 97:\n-#line 1560 \"grammar.y\" /* yacc.c:1646  */\n+#line 1566 \"grammar.y\" /* yacc.c:1646  */\n     {\n         (yyval.expression) = (yyvsp[-1].expression);\n       }\n-#line 3224 \"grammar.c\" /* yacc.c:1646  */\n+#line 3230 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 98:\n-#line 1564 \"grammar.y\" /* yacc.c:1646  */\n+#line 1570 \"grammar.y\" /* yacc.c:1646  */\n     {\n         compiler->last_result = yr_parser_emit(\n             yyscanner, OP_FILESIZE, NULL);\n@@ -3234,11 +3240,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         (yyval.expression).type = EXPRESSION_TYPE_INTEGER;\n         (yyval.expression).value.integer = UNDEFINED;\n       }\n-#line 3238 \"grammar.c\" /* yacc.c:1646  */\n+#line 3244 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 99:\n-#line 1574 \"grammar.y\" /* yacc.c:1646  */\n+#line 1580 \"grammar.y\" /* yacc.c:1646  */\n     {\n         yywarning(yyscanner,\n             \"Using deprecated \\\"entrypoint\\\" keyword. Use the \\\"entry_point\\\" \"\n@@ -3252,11 +3258,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         (yyval.expression).type = EXPRESSION_TYPE_INTEGER;\n         (yyval.expression).value.integer = UNDEFINED;\n       }\n-#line 3256 \"grammar.c\" /* yacc.c:1646  */\n+#line 3262 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 100:\n-#line 1588 \"grammar.y\" /* yacc.c:1646  */\n+#line 1594 \"grammar.y\" /* yacc.c:1646  */\n     {\n         CHECK_TYPE((yyvsp[-1].expression), EXPRESSION_TYPE_INTEGER, \"intXXXX or uintXXXX\");\n \n@@ -3272,11 +3278,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         (yyval.expression).type = EXPRESSION_TYPE_INTEGER;\n         (yyval.expression).value.integer = UNDEFINED;\n       }\n-#line 3276 \"grammar.c\" /* yacc.c:1646  */\n+#line 3282 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 101:\n-#line 1604 \"grammar.y\" /* yacc.c:1646  */\n+#line 1610 \"grammar.y\" /* yacc.c:1646  */\n     {\n         compiler->last_result = yr_parser_emit_with_arg(\n             yyscanner, OP_PUSH, (yyvsp[0].integer), NULL, NULL);\n@@ -3286,11 +3292,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         (yyval.expression).type = EXPRESSION_TYPE_INTEGER;\n         (yyval.expression).value.integer = (yyvsp[0].integer);\n       }\n-#line 3290 \"grammar.c\" /* yacc.c:1646  */\n+#line 3296 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 102:\n-#line 1614 \"grammar.y\" /* yacc.c:1646  */\n+#line 1620 \"grammar.y\" /* yacc.c:1646  */\n     {\n         compiler->last_result = yr_parser_emit_with_arg_double(\n             yyscanner, OP_PUSH, (yyvsp[0].double_), NULL, NULL);\n@@ -3299,11 +3305,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n         (yyval.expression).type = EXPRESSION_TYPE_FLOAT;\n       }\n-#line 3303 \"grammar.c\" /* yacc.c:1646  */\n+#line 3309 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 103:\n-#line 1623 \"grammar.y\" /* yacc.c:1646  */\n+#line 1629 \"grammar.y\" /* yacc.c:1646  */\n     {\n         SIZED_STRING* sized_string;\n \n@@ -3328,11 +3334,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         (yyval.expression).type = EXPRESSION_TYPE_STRING;\n         (yyval.expression).value.sized_string = sized_string;\n       }\n-#line 3332 \"grammar.c\" /* yacc.c:1646  */\n+#line 3338 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 104:\n-#line 1648 \"grammar.y\" /* yacc.c:1646  */\n+#line 1654 \"grammar.y\" /* yacc.c:1646  */\n     {\n         compiler->last_result = yr_parser_reduce_string_identifier(\n             yyscanner, (yyvsp[0].c_string), OP_COUNT, UNDEFINED);\n@@ -3344,11 +3350,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         (yyval.expression).type = EXPRESSION_TYPE_INTEGER;\n         (yyval.expression).value.integer = UNDEFINED;\n       }\n-#line 3348 \"grammar.c\" /* yacc.c:1646  */\n+#line 3354 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 105:\n-#line 1660 \"grammar.y\" /* yacc.c:1646  */\n+#line 1666 \"grammar.y\" /* yacc.c:1646  */\n     {\n         compiler->last_result = yr_parser_reduce_string_identifier(\n             yyscanner, (yyvsp[-3].c_string), OP_OFFSET, UNDEFINED);\n@@ -3360,11 +3366,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         (yyval.expression).type = EXPRESSION_TYPE_INTEGER;\n         (yyval.expression).value.integer = UNDEFINED;\n       }\n-#line 3364 \"grammar.c\" /* yacc.c:1646  */\n+#line 3370 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 106:\n-#line 1672 \"grammar.y\" /* yacc.c:1646  */\n+#line 1678 \"grammar.y\" /* yacc.c:1646  */\n     {\n         compiler->last_result = yr_parser_emit_with_arg(\n             yyscanner, OP_PUSH, 1, NULL, NULL);\n@@ -3380,11 +3386,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         (yyval.expression).type = EXPRESSION_TYPE_INTEGER;\n         (yyval.expression).value.integer = UNDEFINED;\n       }\n-#line 3384 \"grammar.c\" /* yacc.c:1646  */\n+#line 3390 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 107:\n-#line 1688 \"grammar.y\" /* yacc.c:1646  */\n+#line 1694 \"grammar.y\" /* yacc.c:1646  */\n     {\n         compiler->last_result = yr_parser_reduce_string_identifier(\n             yyscanner, (yyvsp[-3].c_string), OP_LENGTH, UNDEFINED);\n@@ -3396,11 +3402,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         (yyval.expression).type = EXPRESSION_TYPE_INTEGER;\n         (yyval.expression).value.integer = UNDEFINED;\n       }\n-#line 3400 \"grammar.c\" /* yacc.c:1646  */\n+#line 3406 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 108:\n-#line 1700 \"grammar.y\" /* yacc.c:1646  */\n+#line 1706 \"grammar.y\" /* yacc.c:1646  */\n     {\n         compiler->last_result = yr_parser_emit_with_arg(\n             yyscanner, OP_PUSH, 1, NULL, NULL);\n@@ -3416,11 +3422,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         (yyval.expression).type = EXPRESSION_TYPE_INTEGER;\n         (yyval.expression).value.integer = UNDEFINED;\n       }\n-#line 3420 \"grammar.c\" /* yacc.c:1646  */\n+#line 3426 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 109:\n-#line 1716 \"grammar.y\" /* yacc.c:1646  */\n+#line 1722 \"grammar.y\" /* yacc.c:1646  */\n     {\n         if ((yyvsp[0].expression).type == EXPRESSION_TYPE_INTEGER)  // loop identifier\n         {\n@@ -3465,11 +3471,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n         ERROR_IF(compiler->last_result != ERROR_SUCCESS);\n       }\n-#line 3469 \"grammar.c\" /* yacc.c:1646  */\n+#line 3475 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 110:\n-#line 1761 \"grammar.y\" /* yacc.c:1646  */\n+#line 1767 \"grammar.y\" /* yacc.c:1646  */\n     {\n         CHECK_TYPE((yyvsp[0].expression), EXPRESSION_TYPE_INTEGER | EXPRESSION_TYPE_FLOAT, \"-\");\n \n@@ -3488,11 +3494,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n \n         ERROR_IF(compiler->last_result != ERROR_SUCCESS);\n       }\n-#line 3492 \"grammar.c\" /* yacc.c:1646  */\n+#line 3498 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 111:\n-#line 1780 \"grammar.y\" /* yacc.c:1646  */\n+#line 1786 \"grammar.y\" /* yacc.c:1646  */\n     {\n         compiler->last_result = yr_parser_reduce_operation(\n             yyscanner, \"+\", (yyvsp[-2].expression), (yyvsp[0].expression));\n@@ -3510,11 +3516,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n           (yyval.expression).type = EXPRESSION_TYPE_FLOAT;\n         }\n       }\n-#line 3514 \"grammar.c\" /* yacc.c:1646  */\n+#line 3520 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 112:\n-#line 1798 \"grammar.y\" /* yacc.c:1646  */\n+#line 1804 \"grammar.y\" /* yacc.c:1646  */\n     {\n         compiler->last_result = yr_parser_reduce_operation(\n             yyscanner, \"-\", (yyvsp[-2].expression), (yyvsp[0].expression));\n@@ -3532,11 +3538,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n           (yyval.expression).type = EXPRESSION_TYPE_FLOAT;\n         }\n       }\n-#line 3536 \"grammar.c\" /* yacc.c:1646  */\n+#line 3542 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 113:\n-#line 1816 \"grammar.y\" /* yacc.c:1646  */\n+#line 1822 \"grammar.y\" /* yacc.c:1646  */\n     {\n         compiler->last_result = yr_parser_reduce_operation(\n             yyscanner, \"*\", (yyvsp[-2].expression), (yyvsp[0].expression));\n@@ -3554,11 +3560,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n           (yyval.expression).type = EXPRESSION_TYPE_FLOAT;\n         }\n       }\n-#line 3558 \"grammar.c\" /* yacc.c:1646  */\n+#line 3564 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 114:\n-#line 1834 \"grammar.y\" /* yacc.c:1646  */\n+#line 1840 \"grammar.y\" /* yacc.c:1646  */\n     {\n         compiler->last_result = yr_parser_reduce_operation(\n             yyscanner, \"\\\\\", (yyvsp[-2].expression), (yyvsp[0].expression));\n@@ -3584,11 +3590,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n           (yyval.expression).type = EXPRESSION_TYPE_FLOAT;\n         }\n       }\n-#line 3588 \"grammar.c\" /* yacc.c:1646  */\n+#line 3594 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 115:\n-#line 1860 \"grammar.y\" /* yacc.c:1646  */\n+#line 1866 \"grammar.y\" /* yacc.c:1646  */\n     {\n         CHECK_TYPE((yyvsp[-2].expression), EXPRESSION_TYPE_INTEGER, \"%\");\n         CHECK_TYPE((yyvsp[0].expression), EXPRESSION_TYPE_INTEGER, \"%\");\n@@ -3606,11 +3612,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n           ERROR_IF(compiler->last_result != ERROR_SUCCESS);\n         }\n       }\n-#line 3610 \"grammar.c\" /* yacc.c:1646  */\n+#line 3616 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 116:\n-#line 1878 \"grammar.y\" /* yacc.c:1646  */\n+#line 1884 \"grammar.y\" /* yacc.c:1646  */\n     {\n         CHECK_TYPE((yyvsp[-2].expression), EXPRESSION_TYPE_INTEGER, \"^\");\n         CHECK_TYPE((yyvsp[0].expression), EXPRESSION_TYPE_INTEGER, \"^\");\n@@ -3620,11 +3626,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         (yyval.expression).type = EXPRESSION_TYPE_INTEGER;\n         (yyval.expression).value.integer = OPERATION(^, (yyvsp[-2].expression).value.integer, (yyvsp[0].expression).value.integer);\n       }\n-#line 3624 \"grammar.c\" /* yacc.c:1646  */\n+#line 3630 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 117:\n-#line 1888 \"grammar.y\" /* yacc.c:1646  */\n+#line 1894 \"grammar.y\" /* yacc.c:1646  */\n     {\n         CHECK_TYPE((yyvsp[-2].expression), EXPRESSION_TYPE_INTEGER, \"^\");\n         CHECK_TYPE((yyvsp[0].expression), EXPRESSION_TYPE_INTEGER, \"^\");\n@@ -3634,11 +3640,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         (yyval.expression).type = EXPRESSION_TYPE_INTEGER;\n         (yyval.expression).value.integer = OPERATION(&, (yyvsp[-2].expression).value.integer, (yyvsp[0].expression).value.integer);\n       }\n-#line 3638 \"grammar.c\" /* yacc.c:1646  */\n+#line 3644 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 118:\n-#line 1898 \"grammar.y\" /* yacc.c:1646  */\n+#line 1904 \"grammar.y\" /* yacc.c:1646  */\n     {\n         CHECK_TYPE((yyvsp[-2].expression), EXPRESSION_TYPE_INTEGER, \"|\");\n         CHECK_TYPE((yyvsp[0].expression), EXPRESSION_TYPE_INTEGER, \"|\");\n@@ -3648,11 +3654,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         (yyval.expression).type = EXPRESSION_TYPE_INTEGER;\n         (yyval.expression).value.integer = OPERATION(|, (yyvsp[-2].expression).value.integer, (yyvsp[0].expression).value.integer);\n       }\n-#line 3652 \"grammar.c\" /* yacc.c:1646  */\n+#line 3658 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 119:\n-#line 1908 \"grammar.y\" /* yacc.c:1646  */\n+#line 1914 \"grammar.y\" /* yacc.c:1646  */\n     {\n         CHECK_TYPE((yyvsp[0].expression), EXPRESSION_TYPE_INTEGER, \"~\");\n \n@@ -3662,11 +3668,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         (yyval.expression).value.integer = ((yyvsp[0].expression).value.integer == UNDEFINED) ?\n             UNDEFINED : ~((yyvsp[0].expression).value.integer);\n       }\n-#line 3666 \"grammar.c\" /* yacc.c:1646  */\n+#line 3672 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 120:\n-#line 1918 \"grammar.y\" /* yacc.c:1646  */\n+#line 1924 \"grammar.y\" /* yacc.c:1646  */\n     {\n         CHECK_TYPE((yyvsp[-2].expression), EXPRESSION_TYPE_INTEGER, \"<<\");\n         CHECK_TYPE((yyvsp[0].expression), EXPRESSION_TYPE_INTEGER, \"<<\");\n@@ -3676,11 +3682,11 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         (yyval.expression).type = EXPRESSION_TYPE_INTEGER;\n         (yyval.expression).value.integer = OPERATION(<<, (yyvsp[-2].expression).value.integer, (yyvsp[0].expression).value.integer);\n       }\n-#line 3680 \"grammar.c\" /* yacc.c:1646  */\n+#line 3686 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 121:\n-#line 1928 \"grammar.y\" /* yacc.c:1646  */\n+#line 1934 \"grammar.y\" /* yacc.c:1646  */\n     {\n         CHECK_TYPE((yyvsp[-2].expression), EXPRESSION_TYPE_INTEGER, \">>\");\n         CHECK_TYPE((yyvsp[0].expression), EXPRESSION_TYPE_INTEGER, \">>\");\n@@ -3690,19 +3696,19 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n         (yyval.expression).type = EXPRESSION_TYPE_INTEGER;\n         (yyval.expression).value.integer = OPERATION(>>, (yyvsp[-2].expression).value.integer, (yyvsp[0].expression).value.integer);\n       }\n-#line 3694 \"grammar.c\" /* yacc.c:1646  */\n+#line 3700 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n   case 122:\n-#line 1938 \"grammar.y\" /* yacc.c:1646  */\n+#line 1944 \"grammar.y\" /* yacc.c:1646  */\n     {\n         (yyval.expression) = (yyvsp[0].expression);\n       }\n-#line 3702 \"grammar.c\" /* yacc.c:1646  */\n+#line 3708 \"grammar.c\" /* yacc.c:1646  */\n     break;\n \n \n-#line 3706 \"grammar.c\" /* yacc.c:1646  */\n+#line 3712 \"grammar.c\" /* yacc.c:1646  */\n       default: break;\n     }\n   /* User semantic actions sometimes alter yychar, and that requires\n@@ -3930,5 +3936,5 @@ YYSTYPE yylval YY_INITIAL_VALUE (= yyval_default);\n #endif\n   return yyresult;\n }\n-#line 1943 \"grammar.y\" /* yacc.c:1906  */\n+#line 1949 \"grammar.y\" /* yacc.c:1906  */\n "
    },
    "modified_file_1": {
        "mod_filename": "libyara/grammar.y",
        "status": "modified",
        "add_lines": 6,
        "dele_lines": 0,
        "patch": "@@ -824,6 +824,8 @@ arguments_list\n           case EXPRESSION_TYPE_REGEXP:\n             strlcpy($$, \"r\", MAX_FUNCTION_ARGS);\n             break;\n+          default:\n+            assert(FALSE);\n         }\n \n         ERROR_IF($$ == NULL);\n@@ -853,6 +855,8 @@ arguments_list\n             case EXPRESSION_TYPE_REGEXP:\n               strlcat($1, \"r\", MAX_FUNCTION_ARGS);\n               break;\n+            default:\n+              assert(FALSE);\n           }\n         }\n \n@@ -1022,6 +1026,8 @@ expression\n           compiler->loop_depth--;\n           compiler->loop_identifier[compiler->loop_depth] = NULL;\n         }\n+\n+        YYERROR;\n       }\n     | _FOR_ for_expression _IDENTIFIER_ _IN_\n       {"
    }
}