{
    "current_hash": "9eee997d599a89492281fc7ffdd79d88cd61afc3",
    "parent_hash": "60660e00b80bad0fadcf39aee86f6f8756c94f91",
    "modified_file_0": {
        "mod_filename": "src/tunnel.c",
        "status": "modified",
        "add_lines": 5,
        "dele_lines": 3,
        "patch": "@@ -652,7 +652,6 @@ static int ssl_verify_cert(struct tunnel *tunnel)\n \tchar *line;\n \tint i;\n \tX509_NAME *subj;\n-\tchar common_name[FIELD_SIZE + 1];\n \n \tSSL_set_verify(tunnel->ssl_handle, SSL_VERIFY_PEER, NULL);\n \n@@ -666,10 +665,13 @@ static int ssl_verify_cert(struct tunnel *tunnel)\n \n #ifdef HAVE_X509_CHECK_HOST\n \t// Use OpenSSL native host validation if v >= 1.0.2.\n-\t// correctly check return value of X509_check_host\n-\tif (X509_check_host(cert, common_name, FIELD_SIZE, 0, NULL) == 1)\n+\t// compare against gateway_host and correctly check return value\n+\t// to fix piror Incorrect use of X509_check_host\n+\tif (X509_check_host(cert, tunnel->config->gateway_host,\n+\t                    0, 0, NULL) == 1)\n \t\tcert_valid = 1;\n #else\n+\tchar common_name[FIELD_SIZE + 1];\n \t// Use explicit Common Name check if native validation not available.\n \t// Note: this will ignore Subject Alternative Name fields.\n \tif (subj"
    }
}