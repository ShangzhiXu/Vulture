{
    "current_hash": "c51f6177576d7e12614c64d316cf0b67addd17c9",
    "parent_hash": "ef26461d40597d594bd4e6c23aee62ebc2ebeb0f",
    "modified_file_0": {
        "mod_filename": "src/ws/cockpitauth.c",
        "status": "modified",
        "add_lines": 8,
        "dele_lines": 5,
        "patch": "@@ -1190,16 +1190,19 @@ cockpit_auth_class_init (CockpitAuthClass *klass)\n   cockpit_authorize_logger (authorize_logger, 0);\n }\n \n-static char *\n+static gchar *\n base64_decode_string (const char *enc)\n {\n+  gchar *dec;\n+  gsize len;\n+\n   if (enc == NULL)\n     return NULL;\n \n-  char *dec = g_strdup (enc);\n-  gsize len;\n-  g_base64_decode_inplace (dec, &len);\n-  dec[len] = '\\0';\n+  dec = (gchar *)g_base64_decode (enc, &len);\n+  if (dec)\n+    dec[len] = '\\0';\n+\n   return dec;\n }\n "
    },
    "modified_file_1": {
        "mod_filename": "src/ws/test-auth.c",
        "status": "modified",
        "add_lines": 6,
        "dele_lines": 0,
        "patch": "@@ -286,6 +286,12 @@ test_headers_bad (Test *test,\n   if (cockpit_auth_check_cookie (test->auth, \"/cockpit\", headers))\n       g_assert_not_reached ();\n \n+  /* Bad encoding */\n+  g_hash_table_remove_all (headers);\n+  g_hash_table_insert (headers, g_strdup (\"Cookie\"), g_strdup (\"cockpit=d\"));\n+  if (cockpit_auth_check_cookie (test->auth, \"/cockpit\", headers))\n+      g_assert_not_reached ();\n+\n   g_hash_table_destroy (headers);\n }\n "
    }
}