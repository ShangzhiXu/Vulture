{
    "current_hash": "fc522ff6eb1bbb85e3de60c60a45762571e48c28",
    "parent_hash": "e77a69270c2c28fcc13eca3778e1921da8a530f4",
    "modified_file_0": {
        "mod_filename": "crawl-ref/source/clua.cc",
        "status": "modified",
        "add_lines": 5,
        "dele_lines": 0,
        "patch": "@@ -304,6 +304,9 @@ int CLua::loadfile(lua_State *ls, const char *filename, bool trusted,\n     while (!f.eof())\n         script += f.get_line() + \"\\n\";\n \n+    if (script[0] == 0x1b)\n+        abort();\n+\n     // prefixing with @ stops lua from adding [string \"%s\"]\n     return luaL_loadbuffer(ls, &script[0], script.length(),\n                            (\"@\" + file).c_str());\n@@ -796,6 +799,8 @@ void CLua::init_libraries()\n \n     lua_pushcfunction(_state, lua_loadstring);\n     lua_setglobal(_state, \"loadstring\");\n+    lua_pushnil(_state);\n+    lua_setglobal(_state, \"load\");\n \n     // Open Crawl bindings\n     cluaopen_kills(_state);"
    }
}