{
    "current_hash": "0ef151550d96cc4460f98832df84b4a1e87c65e9",
    "parent_hash": "b4878b3fc61f456584292ff7380c9145a0af4a1f",
    "modified_file_0": {
        "mod_filename": "src/iperf_api.c",
        "status": "modified",
        "add_lines": 8,
        "dele_lines": 1,
        "patch": "@@ -2670,6 +2670,7 @@ static cJSON *\n JSON_read(int fd)\n {\n     uint32_t hsize, nsize;\n+    size_t strsize;\n     char *str;\n     cJSON *json = NULL;\n     int rc;\n@@ -2682,7 +2683,9 @@ JSON_read(int fd)\n     if (Nread(fd, (char*) &nsize, sizeof(nsize), Ptcp) >= 0) {\n \thsize = ntohl(nsize);\n \t/* Allocate a buffer to hold the JSON */\n-\tstr = (char *) calloc(sizeof(char), hsize+1);\t/* +1 for trailing null */\n+\tstrsize = hsize + 1;              /* +1 for trailing NULL */\n+\tif (strsize) {\n+\tstr = (char *) calloc(sizeof(char), strsize);\n \tif (str != NULL) {\n \t    rc = Nread(fd, str, hsize, Ptcp);\n \t    if (rc >= 0) {\n@@ -2701,6 +2704,10 @@ JSON_read(int fd)\n \t    }\n \t}\n \tfree(str);\n+\t}\n+\telse {\n+\t    printf(\"WARNING:  Data length overflow\\n\");\n+\t}\n     }\n     return json;\n }"
    }
}