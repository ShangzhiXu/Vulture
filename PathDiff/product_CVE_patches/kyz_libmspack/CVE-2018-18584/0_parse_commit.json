{
    "current_hash": "40ef1b4093d77ad3a5cfcee1f5cb6108b3a3bcc2",
    "parent_hash": "8759da8db6ec9e866cb8eb143313f397f925bb4f",
    "modified_file_0": {
        "mod_filename": "libmspack/ChangeLog",
        "status": "modified",
        "add_lines": 8,
        "dele_lines": 0,
        "patch": "@@ -1,3 +1,11 @@\n+2018-10-17  Stuart Caie <kyzer@cabextract.org.uk>\n+\n+\t* cab.h: Make the CAB block input buffer one byte larger, to allow\n+\ta maximum-allowed-size input block and the special extra byte added\n+\tafter the block by cabd_sys_read_block to help Quantum alignment.\n+\tThanks to Henri Salo for reporting this.\n+\n+\n 2018-10-17  Stuart Caie <kyzer@cabextract.org.uk>\n   \n         * chmd_read_headers(): again reject files with blank filenames, this"
    },
    "modified_file_1": {
        "mod_filename": "libmspack/mspack/cab.h",
        "status": "modified",
        "add_lines": 10,
        "dele_lines": 2,
        "patch": "@@ -1,5 +1,5 @@\n /* This file is part of libmspack.\n- * (C) 2003-2004 Stuart Caie.\n+ * (C) 2003-2018 Stuart Caie.\n  *\n  * libmspack is free software; you can redistribute it and/or modify it under\n  * the terms of the GNU Lesser General Public License (LGPL) version 2.1\n@@ -70,6 +70,14 @@\n #define CAB_BLOCKMAX (32768)\n #define CAB_INPUTMAX (CAB_BLOCKMAX+6144)\n \n+/* input buffer needs to be CAB_INPUTMAX + 1 byte to allow for max-sized block\n+ * plus 1 trailer byte added by cabd_sys_read_block() for Quantum alignment.\n+ *\n+ * When MSCABD_PARAM_SALVAGE is set, block size is not checked so can be\n+ * up to 65535 bytes, so max input buffer size needed is 65535 + 1\n+ */\n+#define CAB_INPUTBUF (65535 + 1)\n+\n /* There are no more than 65535 data blocks per folder, so a folder cannot\n  * be more than 32768*65535 bytes in length. As files cannot span more than\n  * one folder, this is also their max offset, length and offset+length limit.\n@@ -101,7 +109,7 @@ struct mscabd_decompress_state {\n   struct mspack_file *infh;          /* input file handle                    */\n   struct mspack_file *outfh;         /* output file handle                   */\n   unsigned char *i_ptr, *i_end;      /* input data consumed, end             */\n-  unsigned char input[CAB_INPUTMAX]; /* one input block of data              */\n+  unsigned char input[CAB_INPUTBUF]; /* one input block of data              */\n };\n \n struct mscab_decompressor_p {"
    }
}