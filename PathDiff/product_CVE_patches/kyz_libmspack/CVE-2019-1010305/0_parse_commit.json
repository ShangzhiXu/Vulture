{
    "current_hash": "2f084136cfe0d05e5bf5703f3e83c6d955234b4d",
    "parent_hash": "cb5d78cd958f80bf0117d5653e6afe625c44003a",
    "modified_file_0": {
        "mod_filename": "libmspack/ChangeLog",
        "status": "modified",
        "add_lines": 8,
        "dele_lines": 0,
        "patch": "@@ -1,3 +1,11 @@\n+2019-02-18  Stuart Caie <kyzer@cabextract.org.uk>\n+\n+\t* chmd_read_headers(): a CHM file name beginning \"::\" but shorter\n+\tthan 33 bytes will lead to reading past the freshly-allocated name\n+\tbuffer - checks for specific control filenames didn't take length\n+\tinto account. Thanks to ADLab of Venustech for the report and\n+\tproof of concept.\n+\n 2018-11-03  Stuart Caie <kyzer@cabextract.org.uk>\n \n \t* configure.ac, doc/Makefile.in, doc/Doxyfile.in: remove these"
    },
    "modified_file_1": {
        "mod_filename": "libmspack/mspack/chmd.c",
        "status": "modified",
        "add_lines": 11,
        "dele_lines": 13,
        "patch": "@@ -483,19 +483,17 @@ static int chmd_read_headers(struct mspack_system *sys, struct mspack_file *fh,\n \n       if (name[0] == ':' && name[1] == ':') {\n         /* system file */\n-        if (memcmp(&name[2], &content_name[2], 31L) == 0) {\n-          if (memcmp(&name[33], &content_name[33], 8L) == 0) {\n-            chm->sec1.content = fi;\n-          }\n-          else if (memcmp(&name[33], &control_name[33], 11L) == 0) {\n-            chm->sec1.control = fi;\n-          }\n-          else if (memcmp(&name[33], &spaninfo_name[33], 8L) == 0) {\n-            chm->sec1.spaninfo = fi;\n-          }\n-          else if (memcmp(&name[33], &rtable_name[33], 72L) == 0) {\n-            chm->sec1.rtable = fi;\n-          }\n+        if (name_len == 40 && memcmp(name, content_name, 40) == 0) {\n+          chm->sec1.content = fi;\n+        }\n+        else if (name_len == 44 && memcmp(name, control_name, 44) == 0) {\n+          chm->sec1.control = fi;\n+        }\n+        else if (name_len == 41 && memcmp(name, spaninfo_name, 41) == 0) {\n+          chm->sec1.spaninfo = fi;\n+        }\n+        else if (name_len == 105 && memcmp(name, rtable_name, 105) == 0) {\n+          chm->sec1.rtable = fi;\n         }\n         fi->next = chm->sysfiles;\n         chm->sysfiles = fi;"
    }
}