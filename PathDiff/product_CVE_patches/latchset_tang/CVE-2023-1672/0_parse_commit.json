{
    "current_hash": "8dbbed10870378f1b2c3cf3df2ea7edca7617096",
    "parent_hash": "d5f1cc5f62a47766737caacaefde2a148dce92b0",
    "modified_file_0": {
        "mod_filename": "src/keys.c",
        "status": "modified",
        "add_lines": 3,
        "dele_lines": 0,
        "patch": "@@ -307,6 +307,9 @@ create_new_keys(const char* jwkdir)\n {\n     const char* alg[] = {\"ES512\", \"ECMR\", NULL};\n     char path[PATH_MAX];\n+\n+    /* Set default umask for file creation. */\n+    umask(0337);\n     for (int i = 0; alg[i] != NULL; i++) {\n         json_auto_t* jwk = jwk_generate(alg[i]);\n         if (!jwk) {"
    },
    "modified_file_1": {
        "mod_filename": "src/tangd-keygen.in",
        "status": "modified",
        "add_lines": 4,
        "dele_lines": 0,
        "patch": "@@ -38,6 +38,10 @@ set_perms() {\n [ $# -eq 3 ] && sig=$2 && exc=$3\n \n THP_DEFAULT_HASH=S256     # SHA-256.\n+\n+# Set default umask for file creation.\n+umask 0337\n+\n jwe=$(jose jwk gen -i '{\"alg\":\"ES512\"}')\n [ -z \"$sig\" ] && sig=$(echo \"$jwe\" | jose jwk thp -i- -a \"${THP_DEFAULT_HASH}\")\n echo \"$jwe\" > \"$1/$sig.jwk\""
    },
    "modified_file_2": {
        "mod_filename": "src/tangd-rotate-keys.in",
        "status": "modified",
        "add_lines": 4,
        "dele_lines": 0,
        "patch": "@@ -79,6 +79,10 @@ cd \"${JWKDIR}\" || error \"Unable to change to keys directory '${JWKDIR}'\"\n \n     # Create a new set of keys.\n     DEFAULT_THP_HASH=\"S256\"\n+\n+    # Set default umask for file creation.\n+    umask 0337\n+\n     for alg in \"ES512\" \"ECMR\"; do\n         json=\"$(printf '{\"alg\": \"%s\"}' \"${alg}\")\"\n         jwe=\"$(jose jwk gen --input \"${json}\")\""
    }
}