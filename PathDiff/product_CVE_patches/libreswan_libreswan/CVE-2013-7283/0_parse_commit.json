{
    "current_hash": "ef2d756e73a188401c36133c2e2f7ce4f3c6ae55",
    "parent_hash": "a83c86294dad798bbc5869e5e86fd0aa9e86391c",
    "modified_file_0": {
        "mod_filename": "packaging/fedora/17/libreswan.spec",
        "status": "modified",
        "add_lines": 9,
        "dele_lines": 7,
        "patch": "@@ -149,8 +149,8 @@ install -d %{buildroot}%{_sbindir}\n mkdir -p %{buildroot}%{_libdir}/fipscheck\n %endif\n \n-echo \"include /etc/ipsec.d/*.secrets\" > %{buildroot}%{_sysconfdir}/ipsec.secrets\n-rm -fr %{buildroot}/etc/rc.d/rc*\n+echo \"include %{_sysconfdir}/ipsec.d/*.secrets\" > %{buildroot}%{_sysconfdir}/ipsec.secrets\n+rm -fr %{buildroot}%{_sysconfdir}/rc.d/rc*\n \n %files \n %doc BUGS CHANGES COPYING CREDITS README LICENSE\n@@ -195,11 +195,13 @@ if [ $1 -eq 1 ] ; then\n     # Initial installation \n     /bin/systemctl daemon-reload >/dev/null 2>&1 || :\n fi\n-if [ ! -f /etc/ipsec.d/cert8.db ] ; then\n-echo > /var/tmp/libreswan-nss-pwd\n-certutil -N -f /var/tmp/libreswan-nss-pwd -d /etc/ipsec.d\n-restorecon /etc/ipsec.d/*db 2>/dev/null || :\n-rm /var/tmp/libreswan-nss-pwd\n+if [ ! -f %{_sysconfdir}/ipsec.d/cert8.db ] ; then\n+    TEMPFILE=$(/bin/mktemp %{_sysconfdir}/ipsec.d/nsspw.XXXXXXX)\n+    [ $? -gt 0 ] && TEMPFILE=%{_sysconfdir}/ipsec.d/nsspw.$$\n+    echo > ${TEMPFILE}\n+    certutil -N -f ${TEMPFILE} -d %{_sysconfdir}/ipsec.d\n+    restorecon %{_sysconfdir}/ipsec.d/*db 2>/dev/null || :\n+    rm -f ${TEMPFILE}\n fi\n \n "
    },
    "modified_file_1": {
        "mod_filename": "packaging/fedora/18/libreswan.spec",
        "status": "modified",
        "add_lines": 10,
        "dele_lines": 8,
        "patch": "@@ -99,7 +99,7 @@ Libreswan is based on Openswan-2.6.38 which in turn is based on FreeS/WAN-2.04\n   USE_XAUTHPAM=true \\\n %if %{USE_FIPSCHECK}\n   USE_FIPSCHECK=\"%{USE_FIPSCHECK}\" \\\n-  FIPSPRODUCTCHECK=/etc/system-fips \\\n+  FIPSPRODUCTCHECK=%{_sysconfdir}/system-fips \\\n %endif\n   USE_LIBCAP_NG=\"%{USE_LIBCAP_NG}\" \\\n   USE_LABELED_IPSEC=\"%{USE_LABELED_IPSEC}\" \\\n@@ -153,8 +153,8 @@ install -d %{buildroot}%{_sysconfdir}/prelink.conf.d/\n install -m644 packaging/fedora/libreswan-prelink.conf %{buildroot}%{_sysconfdir}/prelink.conf.d/libreswan-fips.conf\n %endif\n \n-echo \"include /etc/ipsec.d/*.secrets\" > %{buildroot}%{_sysconfdir}/ipsec.secrets\n-rm -fr %{buildroot}/etc/rc.d/rc*\n+echo \"include %{_sysconfdir}/ipsec.d/*.secrets\" > %{buildroot}%{_sysconfdir}/ipsec.secrets\n+rm -fr %{buildroot}%{_sysconfdir}/rc.d/rc*\n \n %files \n %doc BUGS CHANGES COPYING CREDITS README LICENSE\n@@ -190,11 +190,13 @@ rm -fr %{buildroot}/etc/rc.d/rc*\n \n %post \n %systemd_post ipsec.service\n-if [ ! -f /etc/ipsec.d/cert8.db ] ; then\n-echo > /var/tmp/libreswan-nss-pwd\n-certutil -N -f /var/tmp/libreswan-nss-pwd -d /etc/ipsec.d\n-restorecon /etc/ipsec.d/*db 2>/dev/null || :\n-rm /var/tmp/libreswan-nss-pwd\n+if [ ! -f %{_sysconfdir}/ipsec.d/cert8.db ] ; then\n+    TEMPFILE=$(/bin/mktemp %{_sysconfdir}/ipsec.d/nsspw.XXXXXXX)\n+    [ $? -gt 0 ] && TEMPFILE=%{_sysconfdir}/ipsec.d/nsspw.$$\n+    echo > ${TEMPFILE}\n+    certutil -N -f ${TEMPFILE} -d %{_sysconfdir}/ipsec.d\n+    restorecon %{_sysconfdir}/ipsec.d/*db 2>/dev/null || :\n+    rm -f ${TEMPFILE}\n fi\n \n %changelog"
    },
    "modified_file_2": {
        "mod_filename": "packaging/fedora/19/libreswan.spec",
        "status": "modified",
        "add_lines": 10,
        "dele_lines": 8,
        "patch": "@@ -99,7 +99,7 @@ Libreswan is based on Openswan-2.6.38 which in turn is based on FreeS/WAN-2.04\n   USE_XAUTHPAM=true \\\n %if %{USE_FIPSCHECK}\n   USE_FIPSCHECK=\"%{USE_FIPSCHECK}\" \\\n-  FIPSPRODUCTCHECK=/etc/system-fips \\\n+  FIPSPRODUCTCHECK=%{_syconfdir}/system-fips \\\n %endif\n   USE_LIBCAP_NG=\"%{USE_LIBCAP_NG}\" \\\n   USE_LABELED_IPSEC=\"%{USE_LABELED_IPSEC}\" \\\n@@ -153,8 +153,8 @@ install -d %{buildroot}%{_sysconfdir}/prelink.conf.d/\n install -m644 packaging/fedora/libreswan-prelink.conf %{buildroot}%{_sysconfdir}/prelink.conf.d/libreswan-fips.conf\n %endif\n \n-echo \"include /etc/ipsec.d/*.secrets\" > %{buildroot}%{_sysconfdir}/ipsec.secrets\n-rm -fr %{buildroot}/etc/rc.d/rc*\n+echo \"include %{_syconfdir}/ipsec.d/*.secrets\" > %{buildroot}%{_sysconfdir}/ipsec.secrets\n+rm -fr %{buildroot}%{_syconfdir}/rc.d/rc*\n \n %files \n %doc BUGS CHANGES COPYING CREDITS README LICENSE\n@@ -190,11 +190,13 @@ rm -fr %{buildroot}/etc/rc.d/rc*\n \n %post \n %systemd_post ipsec.service\n-if [ ! -f /etc/ipsec.d/cert8.db ] ; then\n-echo > /var/tmp/libreswan-nss-pwd\n-certutil -N -f /var/tmp/libreswan-nss-pwd -d /etc/ipsec.d\n-restorecon /etc/ipsec.d/*db 2>/dev/null || :\n-rm /var/tmp/libreswan-nss-pwd\n+if [ ! -f %{_sysconfdir}/ipsec.d/cert8.db ] ; then\n+    TEMPFILE=$(/bin/mktemp %{_sysconfdir}/ipsec.d/nsspw.XXXXXXX)\n+    [ $? -gt 0 ] && TEMPFILE=%{_sysconfdir}/ipsec.d/nsspw.$$\n+    echo > ${TEMPFILE}\n+    certutil -N -f ${TEMPFILE} -d %{_sysconfdir}/ipsec.d\n+    restorecon %{_sysconfdir}/ipsec.d/*db 2>/dev/null || :\n+    rm -f ${TEMPFILE}\n fi\n \n %changelog"
    },
    "modified_file_3": {
        "mod_filename": "packaging/rhel/5/libreswan.spec",
        "status": "modified",
        "add_lines": 7,
        "dele_lines": 5,
        "patch": "@@ -191,11 +191,13 @@ fi\n \n %post \n /sbin/chkconfig --add ipsec || :\n-if [ ! -f /etc/ipsec.d/cert8.db ] ; then\n-echo > /var/tmp/libreswan-nss-pwd\n-certutil -N -f /var/tmp/libreswan-nss-pwd -d /etc/ipsec.d\n-restorecon /etc/ipsec.d/*db 2>/dev/null || :\n-rm /var/tmp/libreswan-nss-pwd\n+if [ ! -f %{_sysconfdir}/ipsec.d/cert8.db ] ; then\n+    TEMPFILE=$(/bin/mktemp %{_sysconfdir}/ipsec.d/nsspw.XXXXXXX)\n+    [ $? -gt 0 ] && TEMPFILE=%{_sysconfdir}/ipsec.d/nsspw.$$\n+    echo > ${TEMPFILE}\n+    certutil -N -f ${TEMPFILE} -d %{_sysconfdir}/ipsec.d\n+    restorecon %{_sysconfdir}/ipsec.d/*db 2>/dev/null || :\n+    rm -f ${TEMPFILE}\n fi\n \n %changelog"
    },
    "modified_file_4": {
        "mod_filename": "packaging/rhel/6/libreswan.spec",
        "status": "modified",
        "add_lines": 10,
        "dele_lines": 8,
        "patch": "@@ -96,7 +96,7 @@ Libreswan is based on Openswan-2.6.38 which in turn is based on FreeS/WAN-2.04\n   USE_NM=%{USE_NM} \\\n   USE_XAUTHPAM=true \\\n   USE_FIPSCHECK=%{USE_FIPSCHECK} \\\n-  FIPSPRODUCTCHECK=\"/etc/system-fips\" \\\n+  FIPSPRODUCTCHECK=\"%{_sysconfdir}/system-fips\" \\\n   USE_LIBCAP_NG=%{USE_LIBCAP_NG} \\\n   USE_LABELED_IPSEC=%{USE_LABELED_IPSEC} \\\n   USE_LDAP=%{USE_CRL_FETCHING} \\\n@@ -143,8 +143,8 @@ install -d %{buildroot}%{_sbindir}\n # replace with rhel[56] specific version\n install -m 0755 initsystems/sysvinit/init.rhel %{buildroot}%{_initrddir}/ipsec\n \n-echo \"include /etc/ipsec.d/*.secrets\" > %{buildroot}%{_sysconfdir}/ipsec.secrets\n-rm -fr %{buildroot}/etc/rc.d/rc*\n+echo \"include %{_sysconfdir}/ipsec.d/*.secrets\" > %{buildroot}%{_sysconfdir}/ipsec.secrets\n+rm -fr %{buildroot}%{_sysconfdir}/rc.d/rc*\n \n %files \n %doc BUGS CHANGES COPYING CREDITS README LICENSE\n@@ -185,11 +185,13 @@ fi\n %if %{USE_FIPSCHECK}\n prelink -u %{_libexecdir}/ipsec/* 2>/dev/null || :\n %endif\n-if [ ! -f /etc/ipsec.d/cert8.db ] ; then\n-echo > /var/tmp/libreswan-nss-pwd\n-certutil -N -f /var/tmp/libreswan-nss-pwd -d /etc/ipsec.d\n-restorecon /etc/ipsec.d/*db 2>/dev/null || :\n-rm /var/tmp/libreswan-nss-pwd\n+if [ ! -f %{_sysconfdir}/ipsec.d/cert8.db ] ; then\n+    TEMPFILE=$(/bin/mktemp %{_sysconfdir}/ipsec.d/nsspw.XXXXXXX)\n+    [ $? -gt 0 ] && TEMPFILE=%{_sysconfdir}/ipsec.d/nsspw.$$\n+    echo > ${TEMPFILE}\n+    certutil -N -f ${TEMPFILE} -d %{_sysconfdir}/ipsec.d\n+    restorecon %{_sysconfdir}/ipsec.d/*db 2>/dev/null || :\n+    rm -f ${TEMPFILE}\n fi\n \n %changelog"
    },
    "modified_file_5": {
        "mod_filename": "packaging/rhel/7/libreswan.spec",
        "status": "modified",
        "add_lines": 7,
        "dele_lines": 5,
        "patch": "@@ -190,11 +190,13 @@ rm -fr %{buildroot}/etc/rc.d/rc*\n %if %{USE_FIPSCHECK}\n prelink -u %{_libexecdir}/ipsec/* 2>/dev/null || :\n %endif\n-if [ ! -f /etc/ipsec.d/cert8.db ] ; then\n-echo > /var/tmp/libreswan-nss-pwd\n-certutil -N -f /var/tmp/libreswan-nss-pwd -d /etc/ipsec.d\n-restorecon /etc/ipsec.d/*db 2>/dev/null || :\n-rm /var/tmp/libreswan-nss-pwd\n+if [ ! -f %{_sysconfdir}/ipsec.d/cert8.db ] ; then\n+    TEMPFILE=$(/bin/mktemp %{_sysconfdir}/ipsec.d/nsspw.XXXXXXX)\n+    [ $? -gt 0 ] && TEMPFILE=%{_sysconfdir}/ipsec.d/nsspw.$$\n+    echo > ${TEMPFILE}\n+    certutil -N -f ${TEMPFILE} -d %{_sysconfdir}/ipsec.d\n+    restorecon %{_sysconfdir}/ipsec.d/*db 2>/dev/null || :\n+    rm -f ${TEMPFILE}\n fi\n \n %changelog"
    }
}