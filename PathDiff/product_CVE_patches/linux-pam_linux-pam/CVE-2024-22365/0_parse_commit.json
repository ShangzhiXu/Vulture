{
    "current_hash": "031bb5a5d0d950253b68138b498dc93be69a64cb",
    "parent_hash": "cf8c50f2c76fd29c018a2220d243f41801aaadb1",
    "modified_file_0": {
        "mod_filename": "modules/pam_namespace/pam_namespace.c",
        "status": "modified",
        "add_lines": 1,
        "dele_lines": 17,
        "patch": "@@ -1201,7 +1201,7 @@ static int protect_dir(const char *path, mode_t mode, int do_mkdir,\n \tint dfd = AT_FDCWD;\n \tint dfd_next;\n \tint save_errno;\n-\tint flags = O_RDONLY;\n+\tint flags = O_RDONLY | O_DIRECTORY;\n \tint rv = -1;\n \tstruct stat st;\n \n@@ -1255,22 +1255,6 @@ static int protect_dir(const char *path, mode_t mode, int do_mkdir,\n \t\trv = openat(dfd, dir, flags);\n \t}\n \n-\tif (rv != -1) {\n-\t\tif (fstat(rv, &st) != 0) {\n-\t\t\tsave_errno = errno;\n-\t\t\tclose(rv);\n-\t\t\trv = -1;\n-\t\t\terrno = save_errno;\n-\t\t\tgoto error;\n-\t\t}\n-\t\tif (!S_ISDIR(st.st_mode)) {\n-\t\t\tclose(rv);\n-\t\t\terrno = ENOTDIR;\n-\t\t\trv = -1;\n-\t\t\tgoto error;\n-\t\t}\n-\t}\n-\n \tif (flags & O_NOFOLLOW) {\n \t\t/* we are inside user-owned dir - protect */\n \t\tif (protect_mount(rv, p, idata) == -1) {"
    }
}