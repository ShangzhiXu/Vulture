{
    "current_hash": "eff308af425b67093bab25f80f1ae950166bece1",
    "parent_hash": "b8bd09801f4a2c224655e14edffc5793943a33d2",
    "modified_file_0": {
        "mod_filename": "inflate.c",
        "status": "modified",
        "add_lines": 3,
        "dele_lines": 2,
        "patch": "@@ -763,9 +763,10 @@ int flush;\n                 copy = state->length;\n                 if (copy > have) copy = have;\n                 if (copy) {\n+                    len = state->head->extra_len - state->length;\n                     if (state->head != Z_NULL &&\n-                        state->head->extra != Z_NULL) {\n-                        len = state->head->extra_len - state->length;\n+                        state->head->extra != Z_NULL &&\n+                        len < state->head->extra_max) {\n                         zmemcpy(state->head->extra + len, next,\n                                 len + copy > state->head->extra_max ?\n                                 state->head->extra_max - len : copy);"
    }
}