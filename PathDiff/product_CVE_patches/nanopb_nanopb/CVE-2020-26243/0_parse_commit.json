{
    "current_hash": "4fe23595732b6f1254cfc11a9b8d6da900b55b0c",
    "parent_hash": "d9d5dfd869aca4d00a81f671b2445fb4cea0352f",
    "modified_file_0": {
        "mod_filename": "pb_decode.c",
        "status": "modified",
        "add_lines": 6,
        "dele_lines": 3,
        "patch": "@@ -464,14 +464,17 @@ static bool checkreturn decode_static_field(pb_istream_t *stream, pb_wire_type_t\n             }\n \n         case PB_HTYPE_ONEOF:\n-            *(pb_size_t*)iter->pSize = iter->pos->tag;\n-            if (PB_LTYPE(type) == PB_LTYPE_SUBMESSAGE)\n+            if (PB_LTYPE(type) == PB_LTYPE_SUBMESSAGE &&\n+                *(pb_size_t*)iter->pSize != iter->pos->tag)\n             {\n                 /* We memset to zero so that any callbacks are set to NULL.\n-                 * Then set any default values. */\n+                 * This is because the callbacks might otherwise have values\n+                 * from some other union field. */\n                 memset(iter->pData, 0, iter->pos->data_size);\n                 pb_message_set_to_defaults((const pb_field_t*)iter->pos->ptr, iter->pData);\n             }\n+            *(pb_size_t*)iter->pSize = iter->pos->tag;\n+\n             return func(stream, iter->pos, iter->pData);\n \n         default:"
    }
}