sesman/libsesman/verify_user_pam_userpass.c
@@ -207,8 +207,8 @@ auth_uds(const char *user, enum scp_login_status *errorcode)
 /******************************************************************************/
 
 /* returns error */
-int
-auth_start_session(struct auth_info *auth_info, int display_num)
+static int
+auth_start_session_private(struct auth_info *auth_info, int display_num)
 {
     int error;
     char display[256];
@@ -246,6 +246,26 @@ auth_start_session(struct auth_info *auth_info, int display_num)
     return 0;
 }
 
+/******************************************************************************/
+/**
+ * Main routine to start a session
+ *
+ * Calls the private routine and logs an additional error if the private
+ * routine fails
+ */
+int
+auth_start_session(struct auth_info *auth_info, int display_num)
+{
+    int result = auth_start_session_private(auth_info, display_num);
+    if (result != 0)
+    {
+        LOG(LOG_LEVEL_ERROR,
+            "Can't start PAM session. See PAM logging for more info");
+    }
+
+    return result;
+}
+
 /******************************************************************************/
 /* returns error */
 static int