{
    "current_hash": "9b46957ec98d85a572e9ef98301247f39338a3b5",
    "parent_hash": "e37a0eab57215c72b691cf40f565c11fec223851",
    "modified_file_0": {
        "mod_filename": "lib/zip_open.c",
        "status": "modified",
        "add_lines": 6,
        "dele_lines": 1,
        "patch": "@@ -847,7 +847,12 @@ _zip_read_eocd64(zip_source_t *src, zip_buffer_t *buffer, zip_uint64_t buf_offse\n         zip_error_set(error, ZIP_ER_SEEK, EFBIG);\n         return NULL;\n     }\n-    if ((flags & ZIP_CHECKCONS) && offset+size != eocd_offset) {\n+    if (offset+size > buf_offset + eocd_offset) {\n+\t/* cdir spans past EOCD record */\n+\tzip_error_set(error, ZIP_ER_INCONS, 0);\n+\treturn NULL;\n+    }\n+    if ((flags & ZIP_CHECKCONS) && offset+size != buf_offset + eocd_offset) {\n \tzip_error_set(error, ZIP_ER_INCONS, 0);\n \treturn NULL;\n     }"
    }
}