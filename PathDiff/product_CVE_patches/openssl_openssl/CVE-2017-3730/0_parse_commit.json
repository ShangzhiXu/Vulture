{
    "current_hash": "efbe126e3ebb9123ac9d058aa2bb044261342aaa",
    "parent_hash": "793d9b79033c2fffc8e781dab2fd678661b348cd",
    "modified_file_0": {
        "mod_filename": "ssl/statem/statem_clnt.c",
        "status": "modified",
        "add_lines": 9,
        "dele_lines": 0,
        "patch": "@@ -2258,6 +2258,11 @@ static int tls_construct_cke_dhe(SSL *s, unsigned char **p, int *len, int *al)\n         return 0;\n     }\n     ckey = ssl_generate_pkey(skey);\n+    if (ckey == NULL) {\n+        SSLerr(SSL_F_TLS_CONSTRUCT_CKE_DHE, ERR_R_INTERNAL_ERROR);\n+        return 0;\n+    }\n+\n     dh_clnt = EVP_PKEY_get0_DH(ckey);\n \n     if (dh_clnt == NULL || ssl_derive(s, ckey, skey) == 0) {\n@@ -2296,6 +2301,10 @@ static int tls_construct_cke_ecdhe(SSL *s, unsigned char **p, int *len, int *al)\n     }\n \n     ckey = ssl_generate_pkey(skey);\n+    if (ckey == NULL) {\n+        SSLerr(SSL_F_TLS_CONSTRUCT_CKE_ECDHE, ERR_R_INTERNAL_ERROR);\n+        goto err;\n+    }\n \n     if (ssl_derive(s, ckey, skey) == 0) {\n         SSLerr(SSL_F_TLS_CONSTRUCT_CKE_ECDHE, ERR_R_EVP_LIB);"
    }
}