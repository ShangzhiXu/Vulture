{
    "current_hash": "1d878c2daaf913ad01c6d0bc2f247116c8050338",
    "parent_hash": "df854339ea19847e80f442e11f7506d1b7883152",
    "modified_file_0": {
        "mod_filename": "trunk/doc/CHANGELOG.md",
        "status": "modified",
        "add_lines": 2,
        "dele_lines": 0,
        "patch": "@@ -8,6 +8,7 @@ The changelog for SRS.\n \n ## SRS 6.0 Changelog\n \n+* v6.0, 2023-06-05, Fix command injection in demonstration api-server for HTTP callback. v6.0.48\n * v6.0, 2023-06-05, Merge [#3565](https://github.com/ossrs/srs/pull/3565): DTLS: Use bio callback to get fragment packet. v6.0.47 (#3565)\n * v6.0, 2023-05-29, Merge [#3513](https://github.com/ossrs/srs/pull/3513): SSL: Fix SSL_get_error get the error of other coroutine. v6.0.46 (#3513)\n * v6.0, 2023-05-14, Merge [#3534](https://github.com/ossrs/srs/pull/3534): Replace sprintf with snprintf to eliminate compile warnings. v6.0.45 (#3534)\n@@ -61,6 +62,7 @@ The changelog for SRS.\n \n ## SRS 5.0 Changelog\n \n+* v5.0, 2023-06-05, Fix command injection in demonstration api-server for HTTP callback. v5.0.157\n * v5.0, 2023-06-05, Merge [#3565](https://github.com/ossrs/srs/pull/3565): DTLS: Use bio callback to get fragment packet. v5.0.156 (#3565)\n * v5.0, 2023-05-29, Merge [#3513](https://github.com/ossrs/srs/pull/3513): SSL: Fix SSL_get_error get the error of other coroutine. v5.0.155 (#3513)\n * v5.0, 2023-05-13, Merge [#3541](https://github.com/ossrs/srs/pull/3541): asan: Fix memory leak in asan by releasing global IPs when run_directly_or_daemon fails. v5.0.154 (#3541)"
    },
    "modified_file_1": {
        "mod_filename": "trunk/research/api-server/server.go",
        "status": "modified",
        "add_lines": 11,
        "dele_lines": 3,
        "patch": "@@ -400,10 +400,18 @@ func (v *SnapshotJob) do(ffmpegPath, inputUrl string) (err error) {\n \tnormalPicPath := path.Join(outputPicDir, fmt.Sprintf(\"%v\", v.Stream)+\"-%03d.png\")\n \tbestPng := path.Join(outputPicDir, fmt.Sprintf(\"%v-best.png\", v.Stream))\n \n-\tparam := fmt.Sprintf(\"%v -i %v -vf fps=1 -vcodec png -f image2 -an -y -vframes %v -y %v\", ffmpegPath, inputUrl, v.vframes, normalPicPath)\n-\tlog.Println(fmt.Sprintf(\"start snapshot, cmd param=%v\", param))\n+\tparams := []string{\n+\t\t\"-i\", inputUrl,\n+\t\t\"-vf\", \"fps=1\",\n+\t\t\"-vcodec\", \"png\",\n+\t\t\"-f\", \"image2\",\n+\t\t\"-an\",\n+\t\t\"-vframes\", strconv.Itoa(v.vframes),\n+\t\t\"-y\", normalPicPath,\n+\t}\n+\tlog.Println(fmt.Sprintf(\"start snapshot, cmd param=%v %v\", ffmpegPath, strings.Join(params, \" \")))\n \ttimeoutCtx, _ := context.WithTimeout(v.cancelCtx, v.timeout)\n-\tcmd := exec.CommandContext(timeoutCtx, \"/bin/bash\", \"-c\", param)\n+\tcmd := exec.CommandContext(timeoutCtx, ffmpegPath, params...)\n \tif err = cmd.Run(); err != nil {\n \t\tlog.Println(fmt.Sprintf(\"run snapshot %v cmd failed, err is %v\", v.Tag(), err))\n \t\treturn"
    },
    "modified_file_2": {
        "mod_filename": "trunk/src/core/srs_core_version5.hpp",
        "status": "modified",
        "add_lines": 1,
        "dele_lines": 1,
        "patch": "@@ -9,6 +9,6 @@\n \n #define VERSION_MAJOR       5\n #define VERSION_MINOR       0\n-#define VERSION_REVISION    156\n+#define VERSION_REVISION    157\n \n #endif"
    },
    "modified_file_3": {
        "mod_filename": "trunk/src/core/srs_core_version6.hpp",
        "status": "modified",
        "add_lines": 1,
        "dele_lines": 1,
        "patch": "@@ -9,6 +9,6 @@\n \n #define VERSION_MAJOR       6\n #define VERSION_MINOR       0\n-#define VERSION_REVISION    47\n+#define VERSION_REVISION    48\n \n #endif"
    }
}