{
    "current_hash": "3b006ededaf351f1723aea6c727c9edd1b1fff9b",
    "parent_hash": "7c0d06afdf8cd3ecd57d21f714f7f683083875a2",
    "modified_file_0": {
        "mod_filename": "ChangeLog",
        "status": "modified",
        "add_lines": 1,
        "dele_lines": 0,
        "patch": "@@ -1,6 +1,7 @@\n 2019-07-25\n - Rework nfpcapd and add it officially to the nfdump collection.\n - Add nfpcapd man page\n+- Fix potential unsigned integer underflow #171\n \n 2019-07-16\n - Add latency extension if dumping flowcache"
    },
    "modified_file_1": {
        "mod_filename": "bin/ipfix.c",
        "status": "modified",
        "add_lines": 9,
        "dele_lines": 1,
        "patch": "@@ -1247,7 +1247,7 @@ int i;\n \t\tuint32_t table_id, count, size_required;\n \t\tuint32_t num_extensions = 0;\n \n-\t\tif ( size_left && size_left < 4 ) {\n+\t\tif ( size_left < 4 ) {\n \t\t\tLogError(\"Process_ipfix [%u] Template size error at %s line %u\" , \n \t\t\t\texporter->info.id, __FILE__, __LINE__, strerror (errno));\n \t\t\tsize_left = 0;\n@@ -1426,6 +1426,14 @@ ipfix_template_record_t *ipfix_template_record;\n \twhile ( size_left ) {\n \t\tuint32_t id;\n \n+\t\tif ( size_left < 4 ) {\n+\t\t\tLogError(\"Process_ipfix [%u] Template withdraw size error at %s line %u\" , \n+\t\t\t\texporter->info.id, __FILE__, __LINE__, strerror (errno));\n+\t\t\tsize_left = 0;\n+\t\t\tcontinue;\n+\t\t}\n+\n+\n \t\t// map next record.\n \t\tipfix_template_record = (ipfix_template_record_t *)DataPtr;\n \t\tsize_left \t\t-= 4;"
    }
}