{
    "current_hash": "f09c261ca10a31fe41b1262306db7f8f1da0e48a",
    "parent_hash": "5012bedaef2dc60af3955306774b77ef379116e3",
    "modified_file_0": {
        "mod_filename": "CHANGELOG.rst",
        "status": "modified",
        "add_lines": 9,
        "dele_lines": 0,
        "patch": "@@ -1,6 +1,15 @@\n Changelog\n =========\n \n+.. _v41-0-6:\n+\n+41.0.6 - 2023-11-27\n+~~~~~~~~~~~~~~~~~~~\n+\n+* Fixed a null-pointer-dereference and segfault that could occur when loading\n+  certificates from a PKCS#7 bundle.  Credit to **pkuzco** for reporting the\n+  issue. **CVE-2023-49083**\n+\n .. _v41-0-5:\n \n 41.0.5 - 2023-10-24"
    },
    "modified_file_1": {
        "mod_filename": "docs/spelling_wordlist.txt",
        "status": "modified",
        "add_lines": 1,
        "dele_lines": 0,
        "patch": "@@ -38,6 +38,7 @@ decrypted\n decrypting\n deprecations\n DER\n+dereference\n deserialize\n deserialized\n Deserialization"
    },
    "modified_file_2": {
        "mod_filename": "pyproject.toml",
        "status": "modified",
        "add_lines": 1,
        "dele_lines": 1,
        "patch": "@@ -11,7 +11,7 @@ build-backend = \"setuptools.build_meta\"\n \n [project]\n name = \"cryptography\"\n-version = \"41.0.5\"\n+version = \"41.0.6\"\n authors = [\n     {name = \"The Python Cryptographic Authority and individual contributors\", email = \"cryptography-dev@python.org\"}\n ]"
    },
    "modified_file_3": {
        "mod_filename": "src/cryptography/__about__.py",
        "status": "modified",
        "add_lines": 1,
        "dele_lines": 1,
        "patch": "@@ -10,7 +10,7 @@\n     \"__copyright__\",\n ]\n \n-__version__ = \"41.0.5\"\n+__version__ = \"41.0.6\"\n \n \n __author__ = \"The Python Cryptographic Authority and individual contributors\""
    },
    "modified_file_4": {
        "mod_filename": "src/cryptography/hazmat/backends/openssl/backend.py",
        "status": "modified",
        "add_lines": 4,
        "dele_lines": 1,
        "patch": "@@ -1890,9 +1890,12 @@ def _load_pkcs7_certificates(self, p7) -> typing.List[x509.Certificate]:\n                 _Reasons.UNSUPPORTED_SERIALIZATION,\n             )\n \n+        certs: list[x509.Certificate] = []\n+        if p7.d.sign == self._ffi.NULL:\n+            return certs\n+\n         sk_x509 = p7.d.sign.cert\n         num = self._lib.sk_X509_num(sk_x509)\n-        certs = []\n         for i in range(num):\n             x509 = self._lib.sk_X509_value(sk_x509, i)\n             self.openssl_assert(x509 != self._ffi.NULL)"
    },
    "modified_file_5": {
        "mod_filename": "src/rust/src/lib.rs",
        "status": "modified",
        "add_lines": 2,
        "dele_lines": 0,
        "patch": "@@ -3,6 +3,8 @@\n // for complete details.\n \n #![deny(rust_2018_idioms)]\n+// Work-around for https://github.com/PyO3/pyo3/issues/3561\n+#![allow(unknown_lints, clippy::unnecessary_fallible_conversions)]\n \n mod asn1;\n mod backend;"
    },
    "modified_file_6": {
        "mod_filename": "tests/hazmat/primitives/test_pkcs7.py",
        "status": "modified",
        "add_lines": 6,
        "dele_lines": 0,
        "patch": "@@ -89,6 +89,12 @@ def test_load_pkcs7_unsupported_type(self, backend):\n                 mode=\"rb\",\n             )\n \n+    def test_load_pkcs7_empty_certificates(self, backend):\n+        der = b\"\\x30\\x0B\\x06\\x09\\x2A\\x86\\x48\\x86\\xF7\\x0D\\x01\\x07\\x02\"\n+\n+        certificates = pkcs7.load_der_pkcs7_certificates(der)\n+        assert certificates == []\n+\n \n # We have no public verification API and won't be adding one until we get\n # some requirements from users so this function exists to give us basic"
    },
    "modified_file_7": {
        "mod_filename": "vectors/cryptography_vectors/__about__.py",
        "status": "modified",
        "add_lines": 1,
        "dele_lines": 1,
        "patch": "@@ -6,4 +6,4 @@\n     \"__version__\",\n ]\n \n-__version__ = \"41.0.5\"\n+__version__ = \"41.0.6\""
    },
    "modified_file_8": {
        "mod_filename": "vectors/pyproject.toml",
        "status": "modified",
        "add_lines": 1,
        "dele_lines": 1,
        "patch": "@@ -4,7 +4,7 @@ build-backend = \"setuptools.build_meta\"\n \n [project]\n name = \"cryptography_vectors\"\n-version = \"41.0.5\"\n+version = \"41.0.6\"\n authors = [\n     {name = \"The Python Cryptographic Authority and individual contributors\", email = \"cryptography-dev@python.org\"}\n ]"
    }
}