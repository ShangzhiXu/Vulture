{
    "current_hash": "9ab7dbeb3baff67a51d0c5e71465c453be0890b5",
    "parent_hash": "ba61b48fd75b27a26e9bd31c5a5f07c1037222bf",
    "modified_file_0": {
        "mod_filename": "configure",
        "status": "modified",
        "add_lines": 7,
        "dele_lines": 1,
        "patch": "@@ -26,6 +26,9 @@ usage() {\n \techo \"--libdir=/path\t\tdefault: $prefix/lib\"\n \techo \"--includedir=/path\tdefault: $prefix/include\"\n \techo \"--sysconfdir=/path\tdefault: $prefix/etc\"\n+\techo \"--ignore-cve\t\tdefault: no\"\n+\techo \"\tif set to yes ignores CVE-2015-3887 and makes it possible\"\n+\techo \"\tto preload from current dir (insecure)\"\n \tismac && isx86_64 && echo \"--fat-binary : build for both i386 and x86_64 architectures on 64-bit Macs\"\n \techo \"--help : show this text\"\n \texit 1\n@@ -39,7 +42,7 @@ spliteq() {\n }\n \n fat_binary=\n-\n+ignore_cve=no\n parsearg() {\n \tcase \"$1\" in\n \t--prefix=*) prefix=`spliteq $1`;;\n@@ -48,6 +51,8 @@ parsearg() {\n \t--libdir=*) libdir=`spliteq $1`;;\n \t--includedir=*) includedir=`spliteq $1`;;\n \t--sysconfdir=*) sysconfdir=`spliteq $1`;;\n+\t--ignore-cve) ignore_cve=1;;\n+\t--ignore-cve=*) ignore_cve=`spliteq $1`;;\n \t--fat-binary) fat_binary=1;;\n \t--help) usage;;\n \tesac\n@@ -94,6 +99,7 @@ echo bindir=$bindir>>config.mak\n echo libdir=$libdir>>config.mak\n echo includedir=$includedir>>config.mak\n echo sysconfdir=$sysconfdir>>config.mak\n+[ \"$ignore_cve\" = \"no\" ] && echo CPPFLAGS+= -DSUPER_SECURE>>config.mak\n make_cmd=make\n if ismac ; then\n \techo NO_AS_NEEDED=>>config.mak"
    },
    "modified_file_1": {
        "mod_filename": "src/main.c",
        "status": "modified",
        "add_lines": 6,
        "dele_lines": 0,
        "patch": "@@ -33,7 +33,9 @@ static const char *dll_name = DLL_NAME;\n \n static char own_dir[256];\n static const char *dll_dirs[] = {\n+#ifndef SUPER_SECURE /* CVE-2015-3887 */\n \t\".\",\n+#endif\n \town_dir,\n \tLIB_DIR,\n \t\"/lib\",\n@@ -48,7 +50,11 @@ static void set_own_dir(const char *argv0) {\n \twhile(l && argv0[l - 1] != '/')\n \t\tl--;\n \tif(l == 0)\n+#ifdef SUPER_SECURE\n+\t\tmemcpy(own_dir, \"/dev/null/\", 2);\n+#else\n \t\tmemcpy(own_dir, \".\", 2);\n+#endif\n \telse {\n \t\tmemcpy(own_dir, argv0, l - 1);\n \t\town_dir[l] = 0;"
    }
}