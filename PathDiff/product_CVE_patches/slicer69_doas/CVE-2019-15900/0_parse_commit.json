{
    "current_hash": "2f83222829448e5bc4c9391d607ec265a1e06531",
    "parent_hash": "79c6c61a7320947fd4015d5f87e6de6e01e5f76b",
    "modified_file_0": {
        "mod_filename": "Makefile",
        "status": "modified",
        "add_lines": 2,
        "dele_lines": 1,
        "patch": "@@ -5,9 +5,10 @@ PREFIX?=/usr/local\n MANDIR?=$(DESTDIR)$(PREFIX)/man\n SYSCONFDIR?=$(DESTDIR)$(PREFIX)/etc\n OBJECTS=doas.o env.o execvpe.o reallocarray.o y.tab.o\n+OPT?=-O2\n # Can set GLOBAL_PATH here to set PATH for target user.\n # TARGETPATH=-DGLOBAL_PATH=\\\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:\\\"\n-CFLAGS+=-DUSE_PAM -DDOAS_CONF=\\\"${SYSCONFDIR}/doas.conf\\\" $(TARGETPATH)\n+CFLAGS+=-Wall $(OPT) -DUSE_PAM -DDOAS_CONF=\\\"${SYSCONFDIR}/doas.conf\\\" $(TARGETPATH)\n LDFLAGS+=-lpam\n UNAME_S := $(shell uname -s)\n ifeq ($(UNAME_S),Linux)"
    },
    "modified_file_1": {
        "mod_filename": "doas.c",
        "status": "modified",
        "add_lines": 20,
        "dele_lines": 8,
        "patch": "@@ -85,19 +85,25 @@ static int\n parseuid(const char *s, uid_t *uid)\n {\n \tstruct passwd *pw;\n-\tconst char *errstr;\n+\t#if !defined(__linux__) && !defined(__NetBSD__)\n+\tconst char *errstr = NULL;\n+        #else\n+        int status;\n+        #endif\n \n \tif ((pw = getpwnam(s)) != NULL) {\n \t\t*uid = pw->pw_uid;\n \t\treturn 0;\n \t}\n \t#if !defined(__linux__) && !defined(__NetBSD__)\n \t*uid = strtonum(s, 0, UID_MAX, &errstr);\n-\t#else\n-\tsscanf(s, \"%d\", uid);\n-\t#endif\n \tif (errstr)\n \t\treturn -1;\n+\t#else\n+\tstatus = sscanf(s, \"%d\", uid);\n+        if (status != 1)\n+           return -1;\n+\t#endif\n \treturn 0;\n }\n \n@@ -117,19 +123,25 @@ static int\n parsegid(const char *s, gid_t *gid)\n {\n \tstruct group *gr;\n-\tconst char *errstr;\n+\t#if !defined(__linux__) && !defined(__NetBSD__)\n+\tconst char *errstr = NULL;\n+        #else\n+        int status;\n+        #endif\n \n \tif ((gr = getgrnam(s)) != NULL) {\n \t\t*gid = gr->gr_gid;\n \t\treturn 0;\n \t}\n \t#if !defined(__linux__) && !defined(__NetBSD__)\n \t*gid = strtonum(s, 0, GID_MAX, &errstr);\n-\t#else\n-\tsscanf(s, \"%d\", gid);\n-\t#endif\n \tif (errstr)\n \t\treturn -1;\n+\t#else\n+\tstatus = sscanf(s, \"%d\", gid);\n+        if (status != 1)\n+            return -1;\n+\t#endif\n \treturn 0;\n }\n "
    }
}