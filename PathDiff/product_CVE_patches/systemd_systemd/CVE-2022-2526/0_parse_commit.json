{
    "current_hash": "d973d94dec349fb676fdd844f6fe2ada3538f27c",
    "parent_hash": "904dcaf9d4933499f8334859f52ea8497f2d24ff",
    "modified_file_0": {
        "mod_filename": "src/resolve/resolved-dns-stream.c",
        "status": "modified",
        "add_lines": 3,
        "dele_lines": 1,
        "patch": "@@ -46,6 +46,8 @@ static int dns_stream_update_io(DnsStream *s) {\n }\n \n static int dns_stream_complete(DnsStream *s, int error) {\n+        _cleanup_(dns_stream_unrefp) _unused_ DnsStream *ref = dns_stream_ref(s); /* Protect stream while we process it */\n+\n         assert(s);\n \n #if ENABLE_DNS_OVER_TLS\n@@ -273,7 +275,7 @@ static int on_stream_timeout(sd_event_source *es, usec_t usec, void *userdata) {\n }\n \n static int on_stream_io(sd_event_source *es, int fd, uint32_t revents, void *userdata) {\n-        DnsStream *s = userdata;\n+        _cleanup_(dns_stream_unrefp) DnsStream *s = dns_stream_ref(userdata); /* Protect stream while we process it */\n         int r;\n \n         assert(s);"
    }
}