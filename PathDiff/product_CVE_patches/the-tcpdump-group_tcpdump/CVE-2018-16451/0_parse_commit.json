{
    "current_hash": "96480ab95308cd9234b4f09b175ebf60e17792c6",
    "parent_hash": "689c6e6d09125d5c2b91bbc4c3fd958bcb03875b",
    "modified_file_0": {
        "mod_filename": "print-smb.c",
        "status": "modified",
        "add_lines": 8,
        "dele_lines": 3,
        "patch": "@@ -371,16 +371,21 @@ print_trans(netdissect_options *ndo,\n     ND_PRINT((ndo, \"smb_bcc=%u\\n\", bcc));\n     if (bcc > 0) {\n \tsmb_fdata(ndo, data1 + 2, f2, maxbuf - (paramlen + datalen), unicodestr);\n-\n-\tif (strcmp((const char *)(data1 + 2), \"\\\\MAILSLOT\\\\BROWSE\") == 0) {\n+#define MAILSLOT_BROWSE_STR \"\\\\MAILSLOT\\\\BROWSE\"\n+\tND_TCHECK2(*(data1 + 2), strlen(MAILSLOT_BROWSE_STR) + 1);\n+\tif (strcmp((const char *)(data1 + 2), MAILSLOT_BROWSE_STR) == 0) {\n \t    print_browse(ndo, param, paramlen, data, datalen);\n \t    return;\n \t}\n+#undef MAILSLOT_BROWSE_STR\n \n-\tif (strcmp((const char *)(data1 + 2), \"\\\\PIPE\\\\LANMAN\") == 0) {\n+#define PIPE_LANMAN_STR \"\\\\PIPE\\\\LANMAN\"\n+\tND_TCHECK2(*(data1 + 2), strlen(PIPE_LANMAN_STR) + 1);\n+\tif (strcmp((const char *)(data1 + 2), PIPE_LANMAN_STR) == 0) {\n \t    print_ipc(ndo, param, paramlen, data, datalen);\n \t    return;\n \t}\n+#undef PIPE_LANMAN_STR\n \n \tif (paramlen)\n \t    smb_fdata(ndo, param, f3, min(param + paramlen, maxbuf), unicodestr);"
    }
}