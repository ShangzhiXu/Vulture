{
    "current_hash": "24182d959f661327525a20d9a94c98a8ec016778",
    "parent_hash": "af2cf04a9394c1a56227c2289ae8da262828294a",
    "modified_file_0": {
        "mod_filename": "smbutil.c",
        "status": "modified",
        "add_lines": 8,
        "dele_lines": 1,
        "patch": "@@ -807,7 +807,14 @@ smb_fdata(netdissect_options *ndo,\n \t    while (buf < maxbuf) {\n \t\tconst u_char *buf2;\n \t\tdepth++;\n-\t\tbuf2 = smb_fdata(ndo, buf, fmt, maxbuf, unicodestr);\n+\t\t/* Not sure how this relates with the protocol specification,\n+\t\t * but in order to avoid stack exhaustion recurse at most that\n+\t\t * many levels.\n+\t\t */\n+\t\tif (depth == 10)\n+\t\t\tND_PRINT((ndo, \"(too many nested levels, not recursing)\"));\n+\t\telse\n+\t\t\tbuf2 = smb_fdata(ndo, buf, fmt, maxbuf, unicodestr);\n \t\tdepth--;\n \t\tif (buf2 == NULL)\n \t\t    return(NULL);"
    }
}