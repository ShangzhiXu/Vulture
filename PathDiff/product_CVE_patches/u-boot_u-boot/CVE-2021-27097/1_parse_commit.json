{
    "current_hash": "8a7d4cf9820ea16fabd25a6379351b4dc291204b",
    "parent_hash": "6144438fb5c9059dc87cf219bed0c992f70b3509",
    "modified_file_0": {
        "mod_filename": "common/fdt_region.c",
        "status": "modified",
        "add_lines": 11,
        "dele_lines": 0,
        "patch": "@@ -43,6 +43,7 @@ int fdt_find_regions(const void *fdt, char * const inc[], int inc_count,\n \tint depth = -1;\n \tint want = 0;\n \tint base = fdt_off_dt_struct(fdt);\n+\tbool expect_end = false;\n \n \tend = path;\n \t*end = '\\0';\n@@ -59,6 +60,10 @@ int fdt_find_regions(const void *fdt, char * const inc[], int inc_count,\n \t\ttag = fdt_next_tag(fdt, offset, &nextoffset);\n \t\tstop_at = nextoffset;\n \n+\t\t/* If we see two root nodes, something is wrong */\n+\t\tif (expect_end && tag != FDT_END)\n+\t\t\treturn -FDT_ERR_BADLAYOUT;\n+\n \t\tswitch (tag) {\n \t\tcase FDT_PROP:\n \t\t\tinclude = want >= 2;\n@@ -81,6 +86,10 @@ int fdt_find_regions(const void *fdt, char * const inc[], int inc_count,\n \t\t\tif (depth == FDT_MAX_DEPTH)\n \t\t\t\treturn -FDT_ERR_BADSTRUCTURE;\n \t\t\tname = fdt_get_name(fdt, offset, &len);\n+\n+\t\t\t/* The root node must have an empty name */\n+\t\t\tif (!depth && *name)\n+\t\t\t\treturn -FDT_ERR_BADLAYOUT;\n \t\t\tif (end - path + 2 + len >= path_len)\n \t\t\t\treturn -FDT_ERR_NOSPACE;\n \t\t\tif (end != path + 1)\n@@ -108,6 +117,8 @@ int fdt_find_regions(const void *fdt, char * const inc[], int inc_count,\n \t\t\twhile (end > path && *--end != '/')\n \t\t\t\t;\n \t\t\t*end = '\\0';\n+\t\t\tif (depth == -1)\n+\t\t\t\texpect_end = true;\n \t\t\tbreak;\n \n \t\tcase FDT_END:"
    }
}