{
    "current_hash": "5d14ee4e53a81055d34ba280cb8fd90330f22a96",
    "parent_hash": "cf3a4f1e86ecdd24f87b615051b49d8e1968c230",
    "modified_file_0": {
        "mod_filename": "net/nfs.c",
        "status": "modified",
        "add_lines": 4,
        "dele_lines": 0,
        "patch": "@@ -566,11 +566,15 @@ static int nfs_lookup_reply(uchar *pkt, unsigned len)\n \t}\n \n \tif (supported_nfs_versions & NFSV2_FLAG) {\n+\t\tif (((uchar *)&(rpc_pkt.u.reply.data[0]) - (uchar *)(&rpc_pkt) + NFS_FHSIZE) > len)\n+\t\t\treturn -NFS_RPC_DROP;\n \t\tmemcpy(filefh, rpc_pkt.u.reply.data + 1, NFS_FHSIZE);\n \t} else {  /* NFSV3_FLAG */\n \t\tfilefh3_length = ntohl(rpc_pkt.u.reply.data[1]);\n \t\tif (filefh3_length > NFS3_FHSIZE)\n \t\t\tfilefh3_length  = NFS3_FHSIZE;\n+\t\tif (((uchar *)&(rpc_pkt.u.reply.data[0]) - (uchar *)(&rpc_pkt) + filefh3_length) > len)\n+\t\t\treturn -NFS_RPC_DROP;\n \t\tmemcpy(filefh, rpc_pkt.u.reply.data + 2, filefh3_length);\n \t}\n "
    }
}