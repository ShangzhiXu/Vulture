{
    "current_hash": "dd4f16e7e816f2165fba76e3d162cd8d2978dcb2",
    "parent_hash": "3ca100866133aef2d21cdb193ed8d9c39bf56cc0",
    "modified_file_0": {
        "mod_filename": "src/daemon/protocols/lldp.c",
        "status": "modified",
        "add_lines": 7,
        "dele_lines": 2,
        "patch": "@@ -726,6 +726,11 @@ lldp_decode(struct lldpd *cfg, char *frame, int s,\n \t\tcase LLDP_TLV_MGMT_ADDR:\n \t\t\tCHECK_TLV_SIZE(1, \"Management address\");\n \t\t\taddr_str_length = PEEK_UINT8;\n+\t\t\tif (addr_str_length > sizeof(addr_str_buffer)) {\n+\t\t\t\tlog_warnx(\"lldp\", \"too large management address on %s\",\n+\t\t\t\t    hardware->h_ifname);\n+\t\t\t\tgoto malformed;\n+\t\t\t}\n \t\t\tCHECK_TLV_SIZE(1 + addr_str_length, \"Management address\");\n \t\t\tPEEK_BYTES(addr_str_buffer, addr_str_length);\n \t\t\taddr_length = addr_str_length - 1;\n@@ -734,7 +739,7 @@ lldp_decode(struct lldpd *cfg, char *frame, int s,\n \t\t\tCHECK_TLV_SIZE(1 + addr_str_length + 5, \"Management address\");\n \t\t\tiface_subtype = PEEK_UINT8;\n \t\t\tiface_number = PEEK_UINT32;\n-\t\t\t\n+\n \t\t\taf = lldpd_af_from_lldp_proto(addr_family);\n \t\t\tif (af == LLDPD_AF_UNSPEC)\n \t\t\t\tbreak;\n@@ -752,7 +757,7 @@ lldp_decode(struct lldpd *cfg, char *frame, int s,\n \t\t\tTAILQ_INSERT_TAIL(&chassis->c_mgmt, mgmt, m_entries);\n \t\t\tbreak;\n \t\tcase LLDP_TLV_ORG:\n-\t\t\tCHECK_TLV_SIZE(4, \"Organisational\");\n+\t\t\tCHECK_TLV_SIZE(1 + (int)sizeof(orgid), \"Organisational\");\n \t\t\tPEEK_BYTES(orgid, sizeof(orgid));\n \t\t\ttlv_subtype = PEEK_UINT8;\n \t\t\tif (memcmp(dot1, orgid, sizeof(orgid)) == 0) {"
    }
}