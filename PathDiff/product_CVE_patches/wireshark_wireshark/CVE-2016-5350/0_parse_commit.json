{
    "current_hash": "b4d16b4495b732888e12baf5b8a7e9bf2665e22b",
    "parent_hash": "782191f7662c2cd2849524ba279aad0aafcba4de",
    "modified_file_0": {
        "mod_filename": "epan/dissectors/packet-dcerpc-spoolss.c",
        "status": "modified",
        "add_lines": 3,
        "dele_lines": 2,
        "patch": "@@ -1090,7 +1090,7 @@ dissect_spoolss_uint16uni(tvbuff_t *tvb, int offset, packet_info *pinfo _U_,\n \n \t/* Get remaining data in buffer as a string */\n \n-\tremaining = tvb_captured_length_remaining(tvb, offset);\n+\tremaining = tvb_reported_length_remaining(tvb, offset);\n \tif (remaining <= 0) {\n \t\tif (data)\n \t\t\t*data = g_strdup(\"\");\n@@ -6198,9 +6198,10 @@ dissect_spoolss_keybuffer(tvbuff_t *tvb, int offset, packet_info *pinfo,\n \t\tend_offset = tvb_reported_length_remaining(tvb, offset) + 1;\n \t}\n \n-\twhile (offset < end_offset)\n+\twhile (offset > 0 && offset < end_offset) {\n \t\toffset = dissect_spoolss_uint16uni(\n \t\t\ttvb, offset, pinfo, tree, drep, NULL, hf_keybuffer);\n+\t}\n \n \treturn offset;\n }"
    }
}