{
    "current_hash": "23878512c65834d12811b1107d19a001478eca5d",
    "parent_hash": "7cb5fe5e2ae61ae707cf8cc722086515cc0c66e9",
    "modified_file_0": {
        "mod_filename": "wolfcrypt/src/signature.c",
        "status": "modified",
        "add_lines": 30,
        "dele_lines": 0,
        "patch": "@@ -319,6 +319,16 @@ int wc_SignatureGenerateHash(\n     const byte* hash_data, word32 hash_len,\n     byte* sig, word32 *sig_len,\n     const void* key, word32 key_len, WC_RNG* rng)\n+{\n+    return wc_SignatureGenerateHash_ex(hash_type, sig_type, hash_data, hash_len,\n+        sig, sig_len, key, key_len, rng, 1);\n+}\n+\n+int wc_SignatureGenerateHash_ex(\n+    enum wc_HashType hash_type, enum wc_SignatureType sig_type,\n+    const byte* hash_data, word32 hash_len,\n+    byte* sig, word32 *sig_len,\n+    const void* key, word32 key_len, WC_RNG* rng, int verify)\n {\n     int ret;\n \n@@ -393,6 +403,11 @@ int wc_SignatureGenerateHash(\n             break;\n     }\n \n+    if (ret == 0 && verify) {\n+        ret = wc_SignatureVerifyHash(hash_type, sig_type, hash_data, hash_len,\n+            sig, *sig_len, key, key_len);\n+    }\n+\n     return ret;\n }\n \n@@ -401,6 +416,16 @@ int wc_SignatureGenerate(\n     const byte* data, word32 data_len,\n     byte* sig, word32 *sig_len,\n     const void* key, word32 key_len, WC_RNG* rng)\n+{\n+    return wc_SignatureGenerate_ex(hash_type, sig_type, data, data_len, sig,\n+        sig_len, key, key_len, rng, 1);\n+}\n+\n+int wc_SignatureGenerate_ex(\n+    enum wc_HashType hash_type, enum wc_SignatureType sig_type,\n+    const byte* data, word32 data_len,\n+    byte* sig, word32 *sig_len,\n+    const void* key, word32 key_len, WC_RNG* rng, int verify)\n {\n     int ret;\n     word32 hash_len, hash_enc_len;\n@@ -467,6 +492,11 @@ int wc_SignatureGenerate(\n         }\n     }\n \n+    if (ret == 0 && verify) {\n+        ret = wc_SignatureVerifyHash(hash_type, sig_type, hash_data,\n+            hash_enc_len, sig, *sig_len, key, key_len);\n+    }\n+\n #ifdef WOLFSSL_SMALL_STACK\n     XFREE(hash_data, NULL, DYNAMIC_TYPE_TMP_BUFFER);\n #endif"
    },
    "modified_file_1": {
        "mod_filename": "wolfssl/wolfcrypt/signature.h",
        "status": "modified",
        "add_lines": 11,
        "dele_lines": 0,
        "patch": "@@ -62,12 +62,23 @@ WOLFSSL_API int wc_SignatureGenerateHash(\n     const byte* hash_data, word32 hash_len,\n     byte* sig, word32 *sig_len,\n     const void* key, word32 key_len, WC_RNG* rng);\n+WOLFSSL_API int wc_SignatureGenerateHash_ex(\n+    enum wc_HashType hash_type, enum wc_SignatureType sig_type,\n+    const byte* hash_data, word32 hash_len,\n+    byte* sig, word32 *sig_len,\n+    const void* key, word32 key_len, WC_RNG* rng, int verify);\n WOLFSSL_API int wc_SignatureGenerate(\n     enum wc_HashType hash_type, enum wc_SignatureType sig_type,\n     const byte* data, word32 data_len,\n     byte* sig, word32 *sig_len,\n     const void* key, word32 key_len,\n     WC_RNG* rng);\n+WOLFSSL_API int wc_SignatureGenerate_ex(\n+    enum wc_HashType hash_type, enum wc_SignatureType sig_type,\n+    const byte* data, word32 data_len,\n+    byte* sig, word32 *sig_len,\n+    const void* key, word32 key_len,\n+    WC_RNG* rng, int verify);\n \n #ifdef __cplusplus\n     } /* extern \"C\" */"
    }
}